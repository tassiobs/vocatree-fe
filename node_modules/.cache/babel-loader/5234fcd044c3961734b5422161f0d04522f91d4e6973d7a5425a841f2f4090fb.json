{"ast":null,"code":"import axios from 'axios';\nclass ApiClient {\n  setOnAuthFailure(callback) {\n    this.onAuthFailure = callback;\n  }\n  constructor(baseURL = process.env.REACT_APP_API_URL || 'https://web-production-89a2.up.railway.app/') {\n    var _process$env$REACT_AP;\n    this.client = void 0;\n    this.baseURL = void 0;\n    this.isRefreshing = false;\n    this.failedQueue = [];\n    this.onAuthFailure = void 0;\n    const sanitizedEnv = (_process$env$REACT_AP = process.env.REACT_APP_API_URL) === null || _process$env$REACT_AP === void 0 ? void 0 : _process$env$REACT_AP.trim();\n    const deprecatedHosts = ['https://vocatree-production-17ae.up.railway.app', 'https://vocatree-production-17ae.up.railway.app/'];\n    if (sanitizedEnv && deprecatedHosts.includes(sanitizedEnv)) {\n      console.warn('Detected deprecated REACT_APP_API_URL value, overriding to new production host.');\n      baseURL = 'https://web-production-89a2.up.railway.app/';\n    }\n    this.baseURL = baseURL;\n    if (typeof window !== 'undefined') {\n      console.log('ApiClient baseURL resolved:', {\n        envValue: process.env.REACT_APP_API_URL,\n        finalBaseURL: this.baseURL\n      });\n    }\n    this.client = axios.create({\n      baseURL: this.baseURL,\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      withCredentials: true,\n      // REQUIRED: Send cookies with all requests (cross-origin)\n      xsrfCookieName: undefined,\n      // Disable CSRF token handling - not needed for our use case\n      xsrfHeaderName: undefined\n    });\n\n    // Request interceptor - ensure withCredentials is always true\n    this.client.interceptors.request.use(config => {\n      var _config$url, _config$method2, _config$url2;\n      // CRITICAL: Ensure withCredentials is always set to true for cookie-based auth\n      // This is required for cross-origin cookie support\n      config.withCredentials = true;\n\n      // Log if withCredentials somehow got disabled\n      if (!config.withCredentials) {\n        console.error('‚ö†Ô∏è WARNING: withCredentials was false! Forcing to true.');\n      }\n\n      // Log auth-related requests for debugging\n      if ((_config$url = config.url) !== null && _config$url !== void 0 && _config$url.includes('/auth/')) {\n        var _config$method;\n        console.log('üîê Auth request:', {\n          url: `${this.baseURL}${config.url}`,\n          method: (_config$method = config.method) === null || _config$method === void 0 ? void 0 : _config$method.toUpperCase(),\n          withCredentials: config.withCredentials,\n          headers: Object.keys(config.headers || {}),\n          // Note: HttpOnly cookies won't appear in document.cookie, but should be sent automatically\n          note: 'HttpOnly cookies are sent automatically if withCredentials is true'\n        });\n      }\n\n      // Log request details for debugging\n      if (((_config$method2 = config.method) === null || _config$method2 === void 0 ? void 0 : _config$method2.toUpperCase()) === 'POST' && (_config$url2 = config.url) !== null && _config$url2 !== void 0 && _config$url2.includes('/cards/')) {\n        console.log('POST /cards/ request:', {\n          url: `${this.baseURL}${config.url}`,\n          method: config.method,\n          headers: config.headers,\n          data: config.data,\n          withCredentials: config.withCredentials\n        });\n      }\n      return config;\n    }, error => {\n      return Promise.reject(error);\n    });\n\n    // Response interceptor for 401 handling with refresh\n    this.client.interceptors.response.use(response => response, async error => {\n      var _originalRequest$url, _originalRequest$url2, _error$response;\n      const originalRequest = error.config;\n      const isAuthEndpoint = (_originalRequest$url = originalRequest.url) === null || _originalRequest$url === void 0 ? void 0 : _originalRequest$url.includes('/auth/');\n\n      // Handle 401 Unauthorized (but skip refresh for auth endpoints to avoid loops)\n      // Also skip if the request is to /auth/signin - let it fail normally with the error message\n      const isSignInEndpoint = (_originalRequest$url2 = originalRequest.url) === null || _originalRequest$url2 === void 0 ? void 0 : _originalRequest$url2.includes('/auth/signin');\n      if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401 && !originalRequest._retry && !isAuthEndpoint && !isSignInEndpoint) {\n        // If we're already refreshing, queue this request\n        if (this.isRefreshing) {\n          return new Promise((resolve, reject) => {\n            this.failedQueue.push({\n              resolve,\n              reject\n            });\n          }).then(() => {\n            return this.client(originalRequest);\n          }).catch(err => {\n            return Promise.reject(err);\n          });\n        }\n        originalRequest._retry = true;\n        this.isRefreshing = true;\n        try {\n          // Attempt to refresh the token using fetch to ensure credentials are included\n          // Use fetch directly for refresh to avoid axios interceptor loops\n          const refreshResponse = await fetch(`${this.baseURL}/auth/refresh`, {\n            method: 'POST',\n            credentials: 'include',\n            headers: {\n              'Content-Type': 'application/json'\n            }\n          });\n          if (!refreshResponse.ok) {\n            throw new Error(`Refresh failed with status ${refreshResponse.status}`);\n          }\n\n          // Process queued requests\n          this.failedQueue.forEach(prom => prom.resolve());\n          this.failedQueue = [];\n\n          // Retry the original request with withCredentials ensured\n          originalRequest.withCredentials = true;\n          return this.client(originalRequest);\n        } catch (refreshError) {\n          // Refresh failed - clear queue and reject\n          this.failedQueue.forEach(prom => prom.reject(refreshError));\n          this.failedQueue = [];\n\n          // Notify auth context about auth failure\n          if (this.onAuthFailure) {\n            this.onAuthFailure();\n          }\n          return Promise.reject(refreshError);\n        } finally {\n          this.isRefreshing = false;\n        }\n      }\n\n      // Handle network vs CORS errors so offline issues don't show generic CORS message\n      if (error.code === 'ERR_NETWORK' || error.message === 'Network Error') {\n        const isBrowser = typeof window !== 'undefined';\n        const isOffline = isBrowser && typeof navigator !== 'undefined' && navigator.onLine === false;\n        const looksLikeCors = !isOffline && !error.response && error.request && (error.request.status === 0 || error.request.readyState === 4);\n        if (isOffline) {\n          const offlineError = new Error('Network Error: Unable to reach the API. Please check your internet connection or whether the server is down.');\n          offlineError.name = 'NetworkOfflineError';\n          return Promise.reject(offlineError);\n        }\n        if (looksLikeCors) {\n          const frontendOrigin = isBrowser ? window.location.origin : 'unknown';\n          const corsError = new Error('CORS Error: The API server is not allowing requests from this origin. ' + `Please ensure the backend CORS configuration includes: ${frontendOrigin}`);\n          corsError.name = 'CORSError';\n          console.error('CORS Error Details:', {\n            frontendOrigin,\n            apiUrl: this.baseURL,\n            error: error.message\n          });\n          return Promise.reject(corsError);\n        }\n      }\n      return Promise.reject(error);\n    });\n  }\n\n  // Authentication\n  async signIn(credentials) {\n    var _credentials$password, _credentials$email, _credentials$password2, _credentials$password3;\n    // Log the request for debugging\n    console.log('Signing in with credentials:', {\n      email: credentials.email,\n      passwordLength: (_credentials$password = credentials.password) === null || _credentials$password === void 0 ? void 0 : _credentials$password.length,\n      emailTrimmed: (_credentials$email = credentials.email) === null || _credentials$email === void 0 ? void 0 : _credentials$email.trim(),\n      passwordTrimmed: (_credentials$password2 = credentials.password) === null || _credentials$password2 === void 0 ? void 0 : (_credentials$password3 = _credentials$password2.trim()) === null || _credentials$password3 === void 0 ? void 0 : _credentials$password3.length\n    });\n\n    // Trim email and password to avoid whitespace issues\n    const trimmedCredentials = {\n      email: credentials.email.trim(),\n      password: credentials.password.trim()\n    };\n    try {\n      // Cookies are set by the backend automatically\n      console.log('Making signin request...', {\n        url: `${this.baseURL}/auth/signin`,\n        method: 'POST',\n        withCredentials: true,\n        data: {\n          email: trimmedCredentials.email,\n          passwordLength: trimmedCredentials.password.length\n        }\n      });\n      const response = await this.client.post('/auth/signin', trimmedCredentials);\n\n      // Check for Set-Cookie headers (axios may not expose these directly)\n      const setCookieHeaders = response.headers['set-cookie'];\n      const hasSetCookieHeaders = !!setCookieHeaders && (Array.isArray(setCookieHeaders) ? setCookieHeaders.length > 0 : true);\n      console.log('‚úÖ Sign in response received:', {\n        status: response.status,\n        statusText: response.statusText,\n        hasSetCookieHeaders: hasSetCookieHeaders,\n        contentType: response.headers['content-type']\n      });\n\n      // Check if Set-Cookie headers are present (note: axios may not expose Set-Cookie in headers)\n      // Check browser DevTools Network tab ‚Üí Response Headers to verify Set-Cookie headers\n      console.log('üìã Next step: Check Network tab ‚Üí /auth/signin ‚Üí Response Headers ‚Üí Set-Cookie');\n      console.log('üìã Then check: Next request ‚Üí Request Headers ‚Üí Cookie: header should contain tokens');\n\n      // Return response data in case it contains user info\n      return response.data;\n    } catch (error) {\n      var _error$response2, _error$response3, _error$response4, _error$config, _error$config2, _error$config3, _error$config4, _error$config4$data, _error$config5, _error$config5$data, _error$config5$data$p, _error$config6, _error$request, _error$request2;\n      console.error('‚ùå Sign in error:', {\n        status: (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status,\n        statusText: (_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.statusText,\n        data: (_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : _error$response4.data,\n        message: error.message,\n        code: error.code,\n        config: {\n          url: (_error$config = error.config) === null || _error$config === void 0 ? void 0 : _error$config.url,\n          method: (_error$config2 = error.config) === null || _error$config2 === void 0 ? void 0 : _error$config2.method,\n          withCredentials: (_error$config3 = error.config) === null || _error$config3 === void 0 ? void 0 : _error$config3.withCredentials,\n          data: {\n            email: (_error$config4 = error.config) === null || _error$config4 === void 0 ? void 0 : (_error$config4$data = _error$config4.data) === null || _error$config4$data === void 0 ? void 0 : _error$config4$data.email,\n            passwordLength: (_error$config5 = error.config) === null || _error$config5 === void 0 ? void 0 : (_error$config5$data = _error$config5.data) === null || _error$config5$data === void 0 ? void 0 : (_error$config5$data$p = _error$config5$data.password) === null || _error$config5$data$p === void 0 ? void 0 : _error$config5$data$p.length\n          },\n          headers: (_error$config6 = error.config) === null || _error$config6 === void 0 ? void 0 : _error$config6.headers\n        },\n        request: {\n          responseURL: (_error$request = error.request) === null || _error$request === void 0 ? void 0 : _error$request.responseURL,\n          status: (_error$request2 = error.request) === null || _error$request2 === void 0 ? void 0 : _error$request2.status\n        }\n      });\n      throw error;\n    }\n  }\n  async refresh() {\n    // Use fetch directly to ensure credentials are always included\n    const response = await fetch(`${this.baseURL}/auth/refresh`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    if (!response.ok) {\n      throw new Error(`Refresh failed with status ${response.status}`);\n    }\n  }\n  async getMe() {\n    try {\n      console.log('üîç Getting user info from /auth/me...');\n      const response = await this.client.get('/auth/me');\n      console.log('‚úÖ /auth/me successful:', response.data);\n      return response.data;\n    } catch (error) {\n      var _error$response5, _error$response6, _error$response7;\n      console.error('‚ùå /auth/me failed:', {\n        status: (_error$response5 = error.response) === null || _error$response5 === void 0 ? void 0 : _error$response5.status,\n        statusText: (_error$response6 = error.response) === null || _error$response6 === void 0 ? void 0 : _error$response6.statusText,\n        data: (_error$response7 = error.response) === null || _error$response7 === void 0 ? void 0 : _error$response7.data,\n        message: error.message\n      });\n      console.error('‚ö†Ô∏è Check Network tab ‚Üí /auth/me request ‚Üí Request Headers ‚Üí Cookie: header');\n      console.error('‚ö†Ô∏è If Cookie: header is missing, cookies are not being sent');\n      throw error;\n    }\n  }\n  async debugCookies() {\n    try {\n      const response = await this.client.get('/auth/debug-cookies');\n      return response.data;\n    } catch (error) {\n      var _error$response8;\n      console.error('Debug cookies error:', error);\n      return {\n        error: ((_error$response8 = error.response) === null || _error$response8 === void 0 ? void 0 : _error$response8.data) || error.message\n      };\n    }\n  }\n  async updatePassword(passwordData) {\n    await this.client.put('/auth/update-password', passwordData);\n  }\n  async logout() {\n    try {\n      await this.client.post('/auth/logout');\n    } catch (error) {\n      // Even if logout fails, we should clear local state\n      console.warn('Logout endpoint failed:', error.message);\n    }\n  }\n\n  // Cards\n  async createCard(card) {\n    try {\n      const response = await this.client.post('/cards/', card);\n      return response.data;\n    } catch (error) {\n      var _error$response9, _error$response0, _error$config7;\n      // Log detailed error information for debugging\n      console.error('createCard error details:', {\n        url: `${this.baseURL}/cards/`,\n        method: 'POST',\n        data: card,\n        errorCode: error.code,\n        errorMessage: error.message,\n        responseStatus: (_error$response9 = error.response) === null || _error$response9 === void 0 ? void 0 : _error$response9.status,\n        responseData: (_error$response0 = error.response) === null || _error$response0 === void 0 ? void 0 : _error$response0.data,\n        requestHeaders: (_error$config7 = error.config) === null || _error$config7 === void 0 ? void 0 : _error$config7.headers\n      });\n      throw error;\n    }\n  }\n  async getCards(params) {\n    const response = await this.client.get('/cards/', {\n      params\n    });\n    return response.data;\n  }\n  async getCard(id) {\n    const response = await this.client.get(`/cards/${id}`);\n    return response.data;\n  }\n  async updateCard(id, card) {\n    const response = await this.client.patch(`/cards/${id}`, card);\n    return response.data;\n  }\n  async aiEnrichCard(id, data) {\n    const response = await this.client.patch(`/cards/${id}/ai-enrich`, data);\n    return response.data;\n  }\n  async createAICard(data) {\n    const response = await this.client.post('/cards/ai-card', data);\n    return response.data;\n  }\n  async deleteCard(id) {\n    const callId = Math.random().toString(36).substr(2, 9);\n    console.log(`[${callId}] API: DELETE /cards/${id}`);\n    try {\n      await this.client.delete(`/cards/${id}`);\n      console.log(`[${callId}] API: Successfully deleted card ${id}`);\n    } catch (error) {\n      var _error$response1;\n      console.error(`[${callId}] API: Failed to delete card ${id}:`, ((_error$response1 = error.response) === null || _error$response1 === void 0 ? void 0 : _error$response1.data) || error.message);\n      throw error;\n    }\n  }\n  async deleteCardBulk(id) {\n    const callId = Math.random().toString(36).substr(2, 9);\n    console.log(`[${callId}] API: DELETE /cards/${id}/bulk`);\n    try {\n      await this.client.delete(`/cards/${id}/bulk`);\n      console.log(`[${callId}] API: Successfully bulk deleted card ${id}`);\n    } catch (error) {\n      var _error$response10;\n      console.error(`[${callId}] API: Failed to bulk delete card ${id}:`, ((_error$response10 = error.response) === null || _error$response10 === void 0 ? void 0 : _error$response10.data) || error.message);\n      throw error;\n    }\n  }\n  async moveCard(id, newParentId) {\n    await this.client.patch(`/cards/${id}/move`, {\n      new_parent_id: newParentId\n    });\n  }\n  async getCardsByParent(parentId, params) {\n    const response = await this.client.get(`/cards/by-parent/${parentId}`, {\n      params\n    });\n    return response.data;\n  }\n  async getCardsHierarchy(categoryId) {\n    const params = categoryId ? {\n      category_id: categoryId\n    } : {};\n    const response = await this.client.get('/cards/hierarchy', {\n      params\n    });\n    return response.data;\n  }\n\n  // Categories\n  async getCategories() {\n    const response = await this.client.get('/categories/');\n    return response.data.items;\n  }\n  async createCategory(name) {\n    const response = await this.client.post('/categories/', {\n      name\n    });\n    return response.data;\n  }\n  async updateCategory(id, category) {\n    const response = await this.client.patch(`/categories/${id}`, category);\n    return response.data;\n  }\n  async generateAITree(data) {\n    const response = await this.client.post('/categories/ai-generate-tree', data);\n    return response.data;\n  }\n  async bulkDeleteCategory(id) {\n    console.log(`API: POST /categories/bulk-delete with category_id: ${id}`);\n    try {\n      await this.client.post(`/categories/bulk-delete`, {\n        category_id: id\n      });\n      console.log(`API: Successfully bulk deleted category ${id}`);\n    } catch (error) {\n      var _error$response11;\n      console.error(`API: Failed to bulk delete category ${id}:`, ((_error$response11 = error.response) === null || _error$response11 === void 0 ? void 0 : _error$response11.data) || error.message);\n      throw error;\n    }\n  }\n\n  // No token storage methods needed - using HTTP-only cookies\n}\nexport const apiClient = new ApiClient();\nexport default apiClient;","map":{"version":3,"names":["axios","ApiClient","setOnAuthFailure","callback","onAuthFailure","constructor","baseURL","process","env","REACT_APP_API_URL","_process$env$REACT_AP","client","isRefreshing","failedQueue","sanitizedEnv","trim","deprecatedHosts","includes","console","warn","window","log","envValue","finalBaseURL","create","headers","withCredentials","xsrfCookieName","undefined","xsrfHeaderName","interceptors","request","use","config","_config$url","_config$method2","_config$url2","error","url","_config$method","method","toUpperCase","Object","keys","note","data","Promise","reject","response","_originalRequest$url","_originalRequest$url2","_error$response","originalRequest","isAuthEndpoint","isSignInEndpoint","status","_retry","resolve","push","then","catch","err","refreshResponse","fetch","credentials","ok","Error","forEach","prom","refreshError","code","message","isBrowser","isOffline","navigator","onLine","looksLikeCors","readyState","offlineError","name","frontendOrigin","location","origin","corsError","apiUrl","signIn","_credentials$password","_credentials$email","_credentials$password2","_credentials$password3","email","passwordLength","password","length","emailTrimmed","passwordTrimmed","trimmedCredentials","post","setCookieHeaders","hasSetCookieHeaders","Array","isArray","statusText","contentType","_error$response2","_error$response3","_error$response4","_error$config","_error$config2","_error$config3","_error$config4","_error$config4$data","_error$config5","_error$config5$data","_error$config5$data$p","_error$config6","_error$request","_error$request2","responseURL","refresh","getMe","get","_error$response5","_error$response6","_error$response7","debugCookies","_error$response8","updatePassword","passwordData","put","logout","createCard","card","_error$response9","_error$response0","_error$config7","errorCode","errorMessage","responseStatus","responseData","requestHeaders","getCards","params","getCard","id","updateCard","patch","aiEnrichCard","createAICard","deleteCard","callId","Math","random","toString","substr","delete","_error$response1","deleteCardBulk","_error$response10","moveCard","newParentId","new_parent_id","getCardsByParent","parentId","getCardsHierarchy","categoryId","category_id","getCategories","items","createCategory","updateCategory","category","generateAITree","bulkDeleteCategory","_error$response11","apiClient"],"sources":["/Users/tassiobs/Documents/vocatree-fe/src/services/api.ts"],"sourcesContent":["import axios, { AxiosInstance, AxiosResponse, InternalAxiosRequestConfig } from 'axios';\nimport {\n  AuthSignInRequest,\n  AuthToken,\n  AuthUpdatePasswordRequest,\n  AuthMeResponse,\n  Card,\n  CardCreate,\n  CardUpdate,\n  CardAIEnrichRequest,\n  CardListResponse,\n  Category,\n  CategoryListResponse,\n  CategoryUpdate,\n  EvaluateMeaningRequest,\n  EvaluateMeaningResponse\n} from '../types/api';\n\nclass ApiClient {\n  private client: AxiosInstance;\n  private baseURL: string;\n  private isRefreshing: boolean = false;\n  private failedQueue: Array<{\n    resolve: (value?: any) => void;\n    reject: (reason?: any) => void;\n  }> = [];\n  private onAuthFailure?: () => void;\n\n  setOnAuthFailure(callback: () => void) {\n    this.onAuthFailure = callback;\n  }\n\n  constructor(baseURL: string = process.env.REACT_APP_API_URL || 'https://web-production-89a2.up.railway.app/') {\n    const sanitizedEnv = process.env.REACT_APP_API_URL?.trim();\n    const deprecatedHosts = ['https://vocatree-production-17ae.up.railway.app', 'https://vocatree-production-17ae.up.railway.app/'];\n    if (sanitizedEnv && deprecatedHosts.includes(sanitizedEnv)) {\n      console.warn('Detected deprecated REACT_APP_API_URL value, overriding to new production host.');\n      baseURL = 'https://web-production-89a2.up.railway.app/';\n    }\n    this.baseURL = baseURL;\n    if (typeof window !== 'undefined') {\n      console.log('ApiClient baseURL resolved:', {\n        envValue: process.env.REACT_APP_API_URL,\n        finalBaseURL: this.baseURL,\n      });\n    }\n    this.client = axios.create({\n      baseURL: this.baseURL,\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      withCredentials: true, // REQUIRED: Send cookies with all requests (cross-origin)\n      xsrfCookieName: undefined, // Disable CSRF token handling - not needed for our use case\n      xsrfHeaderName: undefined,\n    });\n\n    // Request interceptor - ensure withCredentials is always true\n    this.client.interceptors.request.use(\n      (config) => {\n        // CRITICAL: Ensure withCredentials is always set to true for cookie-based auth\n        // This is required for cross-origin cookie support\n        config.withCredentials = true;\n        \n        // Log if withCredentials somehow got disabled\n        if (!config.withCredentials) {\n          console.error('‚ö†Ô∏è WARNING: withCredentials was false! Forcing to true.');\n        }\n        \n        // Log auth-related requests for debugging\n        if (config.url?.includes('/auth/')) {\n          console.log('üîê Auth request:', {\n            url: `${this.baseURL}${config.url}`,\n            method: config.method?.toUpperCase(),\n            withCredentials: config.withCredentials,\n            headers: Object.keys(config.headers || {}),\n            // Note: HttpOnly cookies won't appear in document.cookie, but should be sent automatically\n            note: 'HttpOnly cookies are sent automatically if withCredentials is true',\n          });\n        }\n        \n        // Log request details for debugging\n        if (config.method?.toUpperCase() === 'POST' && config.url?.includes('/cards/')) {\n          console.log('POST /cards/ request:', {\n            url: `${this.baseURL}${config.url}`,\n            method: config.method,\n            headers: config.headers,\n            data: config.data,\n            withCredentials: config.withCredentials,\n          });\n        }\n        return config;\n      },\n      (error) => {\n        return Promise.reject(error);\n      }\n    );\n\n    // Response interceptor for 401 handling with refresh\n    this.client.interceptors.response.use(\n      (response) => response,\n      async (error) => {\n        const originalRequest = error.config as InternalAxiosRequestConfig & { _retry?: boolean };\n        const isAuthEndpoint = originalRequest.url?.includes('/auth/');\n\n        // Handle 401 Unauthorized (but skip refresh for auth endpoints to avoid loops)\n        // Also skip if the request is to /auth/signin - let it fail normally with the error message\n        const isSignInEndpoint = originalRequest.url?.includes('/auth/signin');\n        if (error.response?.status === 401 && !originalRequest._retry && !isAuthEndpoint && !isSignInEndpoint) {\n          // If we're already refreshing, queue this request\n          if (this.isRefreshing) {\n            return new Promise((resolve, reject) => {\n              this.failedQueue.push({ resolve, reject });\n            })\n              .then(() => {\n                return this.client(originalRequest);\n              })\n              .catch((err) => {\n                return Promise.reject(err);\n              });\n          }\n\n          originalRequest._retry = true;\n          this.isRefreshing = true;\n\n          try {\n            // Attempt to refresh the token using fetch to ensure credentials are included\n            // Use fetch directly for refresh to avoid axios interceptor loops\n            const refreshResponse = await fetch(`${this.baseURL}/auth/refresh`, {\n              method: 'POST',\n              credentials: 'include',\n              headers: {\n                'Content-Type': 'application/json',\n              },\n            });\n            \n            if (!refreshResponse.ok) {\n              throw new Error(`Refresh failed with status ${refreshResponse.status}`);\n            }\n            \n            // Process queued requests\n            this.failedQueue.forEach((prom) => prom.resolve());\n            this.failedQueue = [];\n            \n            // Retry the original request with withCredentials ensured\n            originalRequest.withCredentials = true;\n            return this.client(originalRequest);\n          } catch (refreshError) {\n            // Refresh failed - clear queue and reject\n            this.failedQueue.forEach((prom) => prom.reject(refreshError));\n            this.failedQueue = [];\n            \n            // Notify auth context about auth failure\n            if (this.onAuthFailure) {\n              this.onAuthFailure();\n            }\n            \n            return Promise.reject(refreshError);\n          } finally {\n            this.isRefreshing = false;\n          }\n        }\n\n        // Handle network vs CORS errors so offline issues don't show generic CORS message\n        if (error.code === 'ERR_NETWORK' || error.message === 'Network Error') {\n          const isBrowser = typeof window !== 'undefined';\n          const isOffline = isBrowser && typeof navigator !== 'undefined' && navigator.onLine === false;\n          const looksLikeCors =\n            !isOffline &&\n            !error.response &&\n            error.request &&\n            (error.request.status === 0 || error.request.readyState === 4);\n\n          if (isOffline) {\n            const offlineError = new Error(\n              'Network Error: Unable to reach the API. Please check your internet connection or whether the server is down.'\n            );\n            offlineError.name = 'NetworkOfflineError';\n            return Promise.reject(offlineError);\n          }\n\n          if (looksLikeCors) {\n            const frontendOrigin = isBrowser ? window.location.origin : 'unknown';\n            const corsError = new Error(\n              'CORS Error: The API server is not allowing requests from this origin. ' +\n              `Please ensure the backend CORS configuration includes: ${frontendOrigin}`\n            );\n            corsError.name = 'CORSError';\n            console.error('CORS Error Details:', {\n              frontendOrigin,\n              apiUrl: this.baseURL,\n              error: error.message\n            });\n            return Promise.reject(corsError);\n          }\n        }\n\n        return Promise.reject(error);\n      }\n    );\n  }\n\n  // Authentication\n  async signIn(credentials: AuthSignInRequest): Promise<any> {\n    // Log the request for debugging\n    console.log('Signing in with credentials:', {\n      email: credentials.email,\n      passwordLength: credentials.password?.length,\n      emailTrimmed: credentials.email?.trim(),\n      passwordTrimmed: credentials.password?.trim()?.length,\n    });\n    \n    // Trim email and password to avoid whitespace issues\n    const trimmedCredentials: AuthSignInRequest = {\n      email: credentials.email.trim(),\n      password: credentials.password.trim(),\n    };\n    \n    try {\n      // Cookies are set by the backend automatically\n      console.log('Making signin request...', {\n        url: `${this.baseURL}/auth/signin`,\n        method: 'POST',\n        withCredentials: true,\n        data: {\n          email: trimmedCredentials.email,\n          passwordLength: trimmedCredentials.password.length,\n        },\n      });\n      \n      const response = await this.client.post('/auth/signin', trimmedCredentials);\n      \n      // Check for Set-Cookie headers (axios may not expose these directly)\n      const setCookieHeaders = response.headers['set-cookie'];\n      const hasSetCookieHeaders = !!setCookieHeaders && (Array.isArray(setCookieHeaders) ? setCookieHeaders.length > 0 : true);\n      \n      console.log('‚úÖ Sign in response received:', {\n        status: response.status,\n        statusText: response.statusText,\n        hasSetCookieHeaders: hasSetCookieHeaders,\n        contentType: response.headers['content-type'],\n      });\n      \n      // Check if Set-Cookie headers are present (note: axios may not expose Set-Cookie in headers)\n      // Check browser DevTools Network tab ‚Üí Response Headers to verify Set-Cookie headers\n      console.log('üìã Next step: Check Network tab ‚Üí /auth/signin ‚Üí Response Headers ‚Üí Set-Cookie');\n      console.log('üìã Then check: Next request ‚Üí Request Headers ‚Üí Cookie: header should contain tokens');\n      \n      // Return response data in case it contains user info\n      return response.data;\n    } catch (error: any) {\n      console.error('‚ùå Sign in error:', {\n        status: error.response?.status,\n        statusText: error.response?.statusText,\n        data: error.response?.data,\n        message: error.message,\n        code: error.code,\n        config: {\n          url: error.config?.url,\n          method: error.config?.method,\n          withCredentials: error.config?.withCredentials,\n          data: {\n            email: error.config?.data?.email,\n            passwordLength: error.config?.data?.password?.length,\n          },\n          headers: error.config?.headers,\n        },\n        request: {\n          responseURL: error.request?.responseURL,\n          status: error.request?.status,\n        },\n      });\n      throw error;\n    }\n  }\n\n  async refresh(): Promise<void> {\n    // Use fetch directly to ensure credentials are always included\n    const response = await fetch(`${this.baseURL}/auth/refresh`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    });\n    \n    if (!response.ok) {\n      throw new Error(`Refresh failed with status ${response.status}`);\n    }\n  }\n\n  async getMe(): Promise<AuthMeResponse> {\n    try {\n      console.log('üîç Getting user info from /auth/me...');\n      const response: AxiosResponse<AuthMeResponse> = await this.client.get('/auth/me');\n      console.log('‚úÖ /auth/me successful:', response.data);\n      return response.data;\n    } catch (error: any) {\n      console.error('‚ùå /auth/me failed:', {\n        status: error.response?.status,\n        statusText: error.response?.statusText,\n        data: error.response?.data,\n        message: error.message,\n      });\n      console.error('‚ö†Ô∏è Check Network tab ‚Üí /auth/me request ‚Üí Request Headers ‚Üí Cookie: header');\n      console.error('‚ö†Ô∏è If Cookie: header is missing, cookies are not being sent');\n      throw error;\n    }\n  }\n\n  async debugCookies(): Promise<any> {\n    try {\n      const response: AxiosResponse<any> = await this.client.get('/auth/debug-cookies');\n      return response.data;\n    } catch (error: any) {\n      console.error('Debug cookies error:', error);\n      return { error: error.response?.data || error.message };\n    }\n  }\n\n  async updatePassword(passwordData: AuthUpdatePasswordRequest): Promise<void> {\n    await this.client.put('/auth/update-password', passwordData);\n  }\n\n  async logout(): Promise<void> {\n    try {\n      await this.client.post('/auth/logout');\n    } catch (error: any) {\n      // Even if logout fails, we should clear local state\n      console.warn('Logout endpoint failed:', error.message);\n    }\n  }\n\n  // Cards\n  async createCard(card: CardCreate): Promise<Card> {\n    try {\n      const response: AxiosResponse<Card> = await this.client.post('/cards/', card);\n      return response.data;\n    } catch (error: any) {\n      // Log detailed error information for debugging\n      console.error('createCard error details:', {\n        url: `${this.baseURL}/cards/`,\n        method: 'POST',\n        data: card,\n        errorCode: error.code,\n        errorMessage: error.message,\n        responseStatus: error.response?.status,\n        responseData: error.response?.data,\n        requestHeaders: error.config?.headers,\n      });\n      throw error;\n    }\n  }\n\n  async getCards(params?: {\n    parent_id?: number | null;\n    limit?: number;\n    offset?: number;\n  }): Promise<CardListResponse> {\n    const response: AxiosResponse<CardListResponse> = await this.client.get('/cards/', { params });\n    return response.data;\n  }\n\n  async getCard(id: number): Promise<Card> {\n    const response: AxiosResponse<Card> = await this.client.get(`/cards/${id}`);\n    return response.data;\n  }\n\n  async updateCard(id: number, card: CardUpdate): Promise<Card> {\n    const response: AxiosResponse<Card> = await this.client.patch(`/cards/${id}`, card);\n    return response.data;\n  }\n\n  async aiEnrichCard(id: number, data: CardAIEnrichRequest): Promise<Card> {\n    const response: AxiosResponse<Card> = await this.client.patch(`/cards/${id}/ai-enrich`, data);\n    return response.data;\n  }\n\n  async createAICard(data: {\n    name: string;\n    language: string;\n    prompt?: string;\n    category_id?: number;\n    parent_id?: number;\n  }): Promise<Card> {\n    const response: AxiosResponse<Card> = await this.client.post('/cards/ai-card', data);\n    return response.data;\n  }\n\n  async deleteCard(id: number): Promise<void> {\n    const callId = Math.random().toString(36).substr(2, 9);\n    console.log(`[${callId}] API: DELETE /cards/${id}`);\n    try {\n      await this.client.delete(`/cards/${id}`);\n      console.log(`[${callId}] API: Successfully deleted card ${id}`);\n    } catch (error: any) {\n      console.error(`[${callId}] API: Failed to delete card ${id}:`, error.response?.data || error.message);\n      throw error;\n    }\n  }\n\n  async deleteCardBulk(id: number): Promise<void> {\n    const callId = Math.random().toString(36).substr(2, 9);\n    console.log(`[${callId}] API: DELETE /cards/${id}/bulk`);\n    try {\n      await this.client.delete(`/cards/${id}/bulk`);\n      console.log(`[${callId}] API: Successfully bulk deleted card ${id}`);\n    } catch (error: any) {\n      console.error(`[${callId}] API: Failed to bulk delete card ${id}:`, error.response?.data || error.message);\n      throw error;\n    }\n  }\n\n  async moveCard(id: number, newParentId: number | null): Promise<void> {\n    await this.client.patch(`/cards/${id}/move`, { new_parent_id: newParentId });\n  }\n\n  async getCardsByParent(parentId: number, params?: {\n    limit?: number;\n    offset?: number;\n  }): Promise<CardListResponse> {\n    const response: AxiosResponse<CardListResponse> = await this.client.get(\n      `/cards/by-parent/${parentId}`,\n      { params }\n    );\n    return response.data;\n  }\n\n  async getCardsHierarchy(categoryId?: number): Promise<Card[]> {\n    const params = categoryId ? { category_id: categoryId } : {};\n    const response: AxiosResponse<Card[]> = await this.client.get('/cards/hierarchy', { params });\n    return response.data;\n  }\n\n  // Categories\n  async getCategories(): Promise<Category[]> {\n    const response: AxiosResponse<CategoryListResponse> = await this.client.get('/categories/');\n    return response.data.items;\n  }\n\n  async createCategory(name: string): Promise<Category> {\n    const response: AxiosResponse<Category> = await this.client.post('/categories/', { name });\n    return response.data;\n  }\n\n  async updateCategory(id: number, category: CategoryUpdate): Promise<Category> {\n    const response: AxiosResponse<Category> = await this.client.patch(`/categories/${id}`, category);\n    return response.data;\n  }\n\n  async generateAITree(data: {\n    language: string;\n    category_name: string;\n    prompt?: string;\n  }): Promise<any> {\n    const response: AxiosResponse<any> = await this.client.post('/categories/ai-generate-tree', data);\n    return response.data;\n  }\n\n  async bulkDeleteCategory(id: number): Promise<void> {\n    console.log(`API: POST /categories/bulk-delete with category_id: ${id}`);\n    try {\n      await this.client.post(`/categories/bulk-delete`, { category_id: id });\n      console.log(`API: Successfully bulk deleted category ${id}`);\n    } catch (error: any) {\n      console.error(`API: Failed to bulk delete category ${id}:`, error.response?.data || error.message);\n      throw error;\n    }\n  }\n\n  // No token storage methods needed - using HTTP-only cookies\n}\n\nexport const apiClient = new ApiClient();\nexport default apiClient;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}