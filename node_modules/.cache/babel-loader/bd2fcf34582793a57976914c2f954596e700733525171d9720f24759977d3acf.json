{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import{useAuth}from'../hooks/useAuth';import{VocabTree}from'./VocabTree';import{LogOut,User,Lock}from'lucide-react';import{UpdatePassword}from'./UpdatePassword';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const Layout=()=>{const{user,logout}=useAuth();const[showUpdatePassword,setShowUpdatePassword]=useState(false);const[showUserMenu,setShowUserMenu]=useState(false);const menuRef=useRef(null);const buttonRef=useRef(null);// Handle click outside to close menu\nuseEffect(()=>{const handleClickOutside=event=>{if(menuRef.current&&!menuRef.current.contains(event.target)&&buttonRef.current&&!buttonRef.current.contains(event.target)){setShowUserMenu(false);}};const handleEscape=event=>{if(event.key==='Escape'){setShowUserMenu(false);}};if(showUserMenu){document.addEventListener('mousedown',handleClickOutside);document.addEventListener('touchstart',handleClickOutside);document.addEventListener('keydown',handleEscape);}return()=>{document.removeEventListener('mousedown',handleClickOutside);document.removeEventListener('touchstart',handleClickOutside);document.removeEventListener('keydown',handleEscape);};},[showUserMenu]);const handleUserMenuClick=()=>{setShowUserMenu(!showUserMenu);};const handleUpdatePassword=()=>{setShowUserMenu(false);setShowUpdatePassword(true);};const handleSignOut=()=>{setShowUserMenu(false);logout();};// Get user initials from email for placeholder\nconst getUserInitials=email=>{if(!email)return'U';const parts=email.split('@')[0].split(/[._-]/);if(parts.length>=2){return(parts[0][0]+parts[1][0]).toUpperCase();}return email[0].toUpperCase();};// Get background color based on email (for consistent color per user)\nconst getAvatarColor=email=>{if(!email)return'bg-blue-500';const colors=['bg-blue-500','bg-purple-500','bg-pink-500','bg-indigo-500','bg-green-500','bg-red-500','bg-yellow-500','bg-teal-500'];const index=email.charCodeAt(0)%colors.length;return colors[index];};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50\",children:[/*#__PURE__*/_jsx(\"header\",{className:\"bg-white shadow-sm border-b border-gray-200\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center h-16\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-bold text-gray-900\",children:\"Vocatree\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-sm text-gray-500\",children:\"English Vocabulary\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"button\",{ref:buttonRef,onClick:handleUserMenuClick,className:\"flex items-center justify-center w-10 h-10 rounded-full hover:ring-2 hover:ring-gray-300 transition-all focus:outline-none focus:ring-2 focus:ring-blue-500\",title:\"User menu\",\"aria-expanded\":showUserMenu,\"aria-haspopup\":\"menu\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-full \".concat(getAvatarColor(user===null||user===void 0?void 0:user.email),\" flex items-center justify-center text-white font-medium text-sm shadow-sm\"),children:user!==null&&user!==void 0&&user.email?getUserInitials(user.email):/*#__PURE__*/_jsx(User,{className:\"h-5 w-5\"})})}),showUserMenu&&/*#__PURE__*/_jsxs(\"div\",{ref:menuRef,className:\"absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-lg py-1 z-50\",role:\"menu\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:handleUpdatePassword,className:\"w-full flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors\",role:\"menuitem\",children:[/*#__PURE__*/_jsx(Lock,{className:\"h-4 w-4 mr-3\"}),\"Update Password\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleSignOut,className:\"w-full flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors\",role:\"menuitem\",children:[/*#__PURE__*/_jsx(LogOut,{className:\"h-4 w-4 mr-3\"}),\"Sign out\"]})]})]})})]})})}),/*#__PURE__*/_jsx(\"main\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\",children:/*#__PURE__*/_jsx(VocabTree,{})}),showUpdatePassword&&/*#__PURE__*/_jsx(UpdatePassword,{onClose:()=>setShowUpdatePassword(false)})]});};","map":{"version":3,"names":["React","useState","useRef","useEffect","useAuth","VocabTree","LogOut","User","Lock","UpdatePassword","jsx","_jsx","jsxs","_jsxs","Layout","user","logout","showUpdatePassword","setShowUpdatePassword","showUserMenu","setShowUserMenu","menuRef","buttonRef","handleClickOutside","event","current","contains","target","handleEscape","key","document","addEventListener","removeEventListener","handleUserMenuClick","handleUpdatePassword","handleSignOut","getUserInitials","email","parts","split","length","toUpperCase","getAvatarColor","colors","index","charCodeAt","className","children","ref","onClick","title","concat","role","onClose"],"sources":["/Users/tassiobs/Documents/vocatree-fe/src/components/Layout.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { useAuth } from '../hooks/useAuth';\nimport { VocabTree } from './VocabTree';\nimport { LogOut, User, Lock } from 'lucide-react';\nimport { UpdatePassword } from './UpdatePassword';\n\nexport const Layout: React.FC = () => {\n  const { user, logout } = useAuth();\n  const [showUpdatePassword, setShowUpdatePassword] = useState(false);\n  const [showUserMenu, setShowUserMenu] = useState(false);\n  const menuRef = useRef<HTMLDivElement>(null);\n  const buttonRef = useRef<HTMLButtonElement>(null);\n\n  // Handle click outside to close menu\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent | TouchEvent) => {\n      if (\n        menuRef.current &&\n        !menuRef.current.contains(event.target as Node) &&\n        buttonRef.current &&\n        !buttonRef.current.contains(event.target as Node)\n      ) {\n        setShowUserMenu(false);\n      }\n    };\n\n    const handleEscape = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        setShowUserMenu(false);\n      }\n    };\n\n    if (showUserMenu) {\n      document.addEventListener('mousedown', handleClickOutside);\n      document.addEventListener('touchstart', handleClickOutside);\n      document.addEventListener('keydown', handleEscape);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n      document.removeEventListener('touchstart', handleClickOutside);\n      document.removeEventListener('keydown', handleEscape);\n    };\n  }, [showUserMenu]);\n\n  const handleUserMenuClick = () => {\n    setShowUserMenu(!showUserMenu);\n  };\n\n  const handleUpdatePassword = () => {\n    setShowUserMenu(false);\n    setShowUpdatePassword(true);\n  };\n\n  const handleSignOut = () => {\n    setShowUserMenu(false);\n    logout();\n  };\n\n  // Get user initials from email for placeholder\n  const getUserInitials = (email: string | undefined): string => {\n    if (!email) return 'U';\n    const parts = email.split('@')[0].split(/[._-]/);\n    if (parts.length >= 2) {\n      return (parts[0][0] + parts[1][0]).toUpperCase();\n    }\n    return email[0].toUpperCase();\n  };\n\n  // Get background color based on email (for consistent color per user)\n  const getAvatarColor = (email: string | undefined): string => {\n    if (!email) return 'bg-blue-500';\n    const colors = [\n      'bg-blue-500',\n      'bg-purple-500',\n      'bg-pink-500',\n      'bg-indigo-500',\n      'bg-green-500',\n      'bg-red-500',\n      'bg-yellow-500',\n      'bg-teal-500',\n    ];\n    const index = email.charCodeAt(0) % colors.length;\n    return colors[index];\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header */}\n      <header className=\"bg-white shadow-sm border-b border-gray-200\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center h-16\">\n            <div className=\"flex items-center\">\n              <h1 className=\"text-xl font-bold text-gray-900\">Vocatree</h1>\n              <span className=\"ml-2 text-sm text-gray-500\">English Vocabulary</span>\n            </div>\n            \n            <div className=\"flex items-center space-x-4\">\n              <div className=\"relative\">\n                <button\n                  ref={buttonRef}\n                  onClick={handleUserMenuClick}\n                  className=\"flex items-center justify-center w-10 h-10 rounded-full hover:ring-2 hover:ring-gray-300 transition-all focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  title=\"User menu\"\n                  aria-expanded={showUserMenu}\n                  aria-haspopup=\"menu\"\n                >\n                  {/* Profile Photo Placeholder */}\n                  <div className={`w-10 h-10 rounded-full ${getAvatarColor(user?.email)} flex items-center justify-center text-white font-medium text-sm shadow-sm`}>\n                    {user?.email ? (\n                      getUserInitials(user.email)\n                    ) : (\n                      <User className=\"h-5 w-5\" />\n                    )}\n                  </div>\n                </button>\n\n                {/* User Menu Dropdown */}\n                {showUserMenu && (\n                  <div\n                    ref={menuRef}\n                    className=\"absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-lg py-1 z-50\"\n                    role=\"menu\"\n                  >\n                    <button\n                      onClick={handleUpdatePassword}\n                      className=\"w-full flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors\"\n                      role=\"menuitem\"\n                    >\n                      <Lock className=\"h-4 w-4 mr-3\" />\n                      Update Password\n                    </button>\n                    <button\n                      onClick={handleSignOut}\n                      className=\"w-full flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors\"\n                      role=\"menuitem\"\n                    >\n                      <LogOut className=\"h-4 w-4 mr-3\" />\n                      Sign out\n                    </button>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      {/* Main content */}\n      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\n        <VocabTree />\n      </main>\n\n      {/* Update Password Modal */}\n      {showUpdatePassword && (\n        <UpdatePassword onClose={() => setShowUpdatePassword(false)} />\n      )}\n    </div>\n  );\n};\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}