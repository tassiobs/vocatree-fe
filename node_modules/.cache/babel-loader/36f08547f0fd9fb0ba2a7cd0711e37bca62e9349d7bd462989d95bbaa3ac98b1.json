{"ast":null,"code":"import { apiClient } from '../services/api';\n\n/**\n * Check if a tree item has children (cards or folders)\n */\nexport const hasChildren = item => {\n  return item.children && item.children.length > 0;\n};\n\n/**\n * Get the count of children for a tree item\n */\nexport const getChildrenCount = item => {\n  return item.children ? item.children.length : 0;\n};\n\n/**\n * Handle conditional delete for a tree item\n * Shows appropriate confirmation message based on whether the item has children\n */\nexport const handleConditionalDelete = async (item, onSuccess, onError) => {\n  const hasChildItems = hasChildren(item);\n  const childrenCount = getChildrenCount(item);\n  let confirmMessage;\n  if (hasChildItems) {\n    var _item$children, _item$children2;\n    const folderCount = ((_item$children = item.children) === null || _item$children === void 0 ? void 0 : _item$children.filter(child => child.is_folder).length) || 0;\n    const cardCount = ((_item$children2 = item.children) === null || _item$children2 === void 0 ? void 0 : _item$children2.filter(child => !child.is_folder).length) || 0;\n    let itemDescription = '';\n    if (folderCount > 0 && cardCount > 0) {\n      itemDescription = `${folderCount} folder${folderCount === 1 ? '' : 's'} and ${cardCount} card${cardCount === 1 ? '' : 's'}`;\n    } else if (folderCount > 0) {\n      itemDescription = `${folderCount} folder${folderCount === 1 ? '' : 's'}`;\n    } else {\n      itemDescription = `${cardCount} card${cardCount === 1 ? '' : 's'}`;\n    }\n    confirmMessage = `This ${item.is_folder ? 'folder' : 'category'} contains ${itemDescription}. Deleting it will also delete all items inside. Do you want to continue?`;\n  } else {\n    confirmMessage = `Are you sure you want to delete this ${item.is_folder ? 'folder' : 'card'}?`;\n  }\n  const confirmed = window.confirm(confirmMessage);\n  if (!confirmed) {\n    return;\n  }\n  try {\n    console.log('Delete item details:', {\n      id: item.id,\n      name: item.name,\n      is_folder: item.is_folder,\n      parent_id: item.parent_id,\n      hasChildren: hasChildItems,\n      isCategory: item.isCategory\n    });\n    if (item.isCategory) {\n      // This is a category - use category bulk delete endpoint\n      console.log(`Deleting category with bulk delete:`, item.id, item.name);\n      await apiClient.bulkDeleteCategory(item.id);\n    } else if (hasChildItems) {\n      // This is a folder with children - use card bulk delete endpoint\n      console.log(`Deleting folder with children using card bulk delete:`, item.id, item.name);\n      await apiClient.deleteCardBulk(item.id);\n    } else {\n      // This is a card or folder without children - use standard delete endpoint\n      console.log(`Deleting ${item.is_folder ? 'folder' : 'card'} without children using standard delete:`, item.id, item.name);\n      await apiClient.deleteCard(item.id);\n    }\n    onSuccess();\n  } catch (error) {\n    var _error$response;\n    console.error('Error deleting item:', error);\n\n    // Handle specific error cases\n    if ((error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 404) {\n      // Item not found - might have been deleted already\n      console.warn(`Item ${item.id} not found, might have been deleted already`);\n      // Still call onSuccess to update the UI since the item is effectively gone\n      onSuccess();\n      return;\n    }\n    if (onError) {\n      onError(error);\n    } else {\n      var _error$response2, _error$response2$data, _error$response3;\n      const errorMessage = (error === null || error === void 0 ? void 0 : (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.detail) || (error === null || error === void 0 ? void 0 : error.message) || 'Unknown error occurred';\n      const statusCode = error === null || error === void 0 ? void 0 : (_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.status;\n      if (statusCode === 404) {\n        alert(`The ${item.is_folder ? 'folder' : 'card'} was not found. It may have been deleted already.`);\n      } else {\n        alert(`Failed to delete ${item.is_folder ? 'folder' : 'card'}: ${errorMessage}`);\n      }\n    }\n  }\n};","map":{"version":3,"names":["apiClient","hasChildren","item","children","length","getChildrenCount","handleConditionalDelete","onSuccess","onError","hasChildItems","childrenCount","confirmMessage","_item$children","_item$children2","folderCount","filter","child","is_folder","cardCount","itemDescription","confirmed","window","confirm","console","log","id","name","parent_id","isCategory","bulkDeleteCategory","deleteCardBulk","deleteCard","error","_error$response","response","status","warn","_error$response2","_error$response2$data","_error$response3","errorMessage","data","detail","message","statusCode","alert"],"sources":["/Users/tassiobs/Documents/vocatree-fe/src/utils/deleteUtils.ts"],"sourcesContent":["import { TreeItem } from '../types';\nimport { apiClient } from '../services/api';\n\n/**\n * Check if a tree item has children (cards or folders)\n */\nexport const hasChildren = (item: TreeItem): boolean => {\n  return item.children && item.children.length > 0;\n};\n\n/**\n * Get the count of children for a tree item\n */\nexport const getChildrenCount = (item: TreeItem): number => {\n  return item.children ? item.children.length : 0;\n};\n\n\n/**\n * Handle conditional delete for a tree item\n * Shows appropriate confirmation message based on whether the item has children\n */\nexport const handleConditionalDelete = async (\n  item: TreeItem,\n  onSuccess: () => void,\n  onError?: (error: any) => void\n): Promise<void> => {\n  const hasChildItems = hasChildren(item);\n  const childrenCount = getChildrenCount(item);\n  \n  let confirmMessage: string;\n  \n  if (hasChildItems) {\n    const folderCount = item.children?.filter(child => child.is_folder).length || 0;\n    const cardCount = item.children?.filter(child => !child.is_folder).length || 0;\n    \n    let itemDescription = '';\n    if (folderCount > 0 && cardCount > 0) {\n      itemDescription = `${folderCount} folder${folderCount === 1 ? '' : 's'} and ${cardCount} card${cardCount === 1 ? '' : 's'}`;\n    } else if (folderCount > 0) {\n      itemDescription = `${folderCount} folder${folderCount === 1 ? '' : 's'}`;\n    } else {\n      itemDescription = `${cardCount} card${cardCount === 1 ? '' : 's'}`;\n    }\n    \n    confirmMessage = `This ${item.is_folder ? 'folder' : 'category'} contains ${itemDescription}. Deleting it will also delete all items inside. Do you want to continue?`;\n  } else {\n    confirmMessage = `Are you sure you want to delete this ${item.is_folder ? 'folder' : 'card'}?`;\n  }\n\n  const confirmed = window.confirm(confirmMessage);\n  \n  if (!confirmed) {\n    return;\n  }\n\n  try {\n    console.log('Delete item details:', {\n      id: item.id,\n      name: item.name,\n      is_folder: item.is_folder,\n      parent_id: item.parent_id,\n      hasChildren: hasChildItems,\n      isCategory: item.isCategory\n    });\n    \n    if (item.isCategory) {\n      // This is a category - use category bulk delete endpoint\n      console.log(`Deleting category with bulk delete:`, item.id, item.name);\n      await apiClient.bulkDeleteCategory(item.id);\n    } else if (hasChildItems) {\n      // This is a folder with children - use card bulk delete endpoint\n      console.log(`Deleting folder with children using card bulk delete:`, item.id, item.name);\n      await apiClient.deleteCardBulk(item.id);\n    } else {\n      // This is a card or folder without children - use standard delete endpoint\n      console.log(`Deleting ${item.is_folder ? 'folder' : 'card'} without children using standard delete:`, item.id, item.name);\n      await apiClient.deleteCard(item.id);\n    }\n    onSuccess();\n  } catch (error: any) {\n    console.error('Error deleting item:', error);\n    \n    // Handle specific error cases\n    if (error?.response?.status === 404) {\n      // Item not found - might have been deleted already\n      console.warn(`Item ${item.id} not found, might have been deleted already`);\n      // Still call onSuccess to update the UI since the item is effectively gone\n      onSuccess();\n      return;\n    }\n    \n    if (onError) {\n      onError(error);\n    } else {\n      const errorMessage = error?.response?.data?.detail || error?.message || 'Unknown error occurred';\n      const statusCode = error?.response?.status;\n      \n      if (statusCode === 404) {\n        alert(`The ${item.is_folder ? 'folder' : 'card'} was not found. It may have been deleted already.`);\n      } else {\n        alert(`Failed to delete ${item.is_folder ? 'folder' : 'card'}: ${errorMessage}`);\n      }\n    }\n  }\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}