{"ast":null,"code":"import axios from'axios';class ApiClient{setOnAuthFailure(callback){this.onAuthFailure=callback;}constructor(){var _process$env$REACT_AP;let baseURL=arguments.length>0&&arguments[0]!==undefined?arguments[0]:process.env.REACT_APP_API_URL||'https://web-production-89a2.up.railway.app/';this.client=void 0;this.baseURL=void 0;this.isRefreshing=false;this.failedQueue=[];this.onAuthFailure=void 0;const sanitizedEnv=(_process$env$REACT_AP=process.env.REACT_APP_API_URL)===null||_process$env$REACT_AP===void 0?void 0:_process$env$REACT_AP.trim();const deprecatedHosts=['https://vocatree-production-17ae.up.railway.app','https://vocatree-production-17ae.up.railway.app/'];if(sanitizedEnv&&deprecatedHosts.includes(sanitizedEnv)){console.warn('Detected deprecated REACT_APP_API_URL value, overriding to new production host.');baseURL='https://web-production-89a2.up.railway.app/';}this.baseURL=baseURL;if(typeof window!=='undefined'){console.log('ApiClient baseURL resolved:',{envValue:process.env.REACT_APP_API_URL,finalBaseURL:this.baseURL});}this.client=axios.create({baseURL:this.baseURL,headers:{'Content-Type':'application/json'},withCredentials:true,// REQUIRED: Send cookies with all requests (cross-origin)\nxsrfCookieName:undefined,// Disable CSRF token handling - not needed for our use case\nxsrfHeaderName:undefined});// Request interceptor - ensure withCredentials is always true\nthis.client.interceptors.request.use(config=>{var _config$url,_config$method2,_config$url2;// CRITICAL: Ensure withCredentials is always set to true for cookie-based auth\n// This is required for cross-origin cookie support\nconfig.withCredentials=true;// Log if withCredentials somehow got disabled\nif(!config.withCredentials){console.error('‚ö†Ô∏è WARNING: withCredentials was false! Forcing to true.');}// Log auth-related requests for debugging\nif((_config$url=config.url)!==null&&_config$url!==void 0&&_config$url.includes('/auth/')){var _config$method;console.log('üîê Auth request:',{url:\"\".concat(this.baseURL).concat(config.url),method:(_config$method=config.method)===null||_config$method===void 0?void 0:_config$method.toUpperCase(),withCredentials:config.withCredentials,headers:Object.keys(config.headers||{}),// Note: HttpOnly cookies won't appear in document.cookie, but should be sent automatically\nnote:'HttpOnly cookies are sent automatically if withCredentials is true'});}// Log request details for debugging\nif(((_config$method2=config.method)===null||_config$method2===void 0?void 0:_config$method2.toUpperCase())==='POST'&&(_config$url2=config.url)!==null&&_config$url2!==void 0&&_config$url2.includes('/cards/')){console.log('POST /cards/ request:',{url:\"\".concat(this.baseURL).concat(config.url),method:config.method,headers:config.headers,data:config.data,withCredentials:config.withCredentials});}return config;},error=>{return Promise.reject(error);});// Response interceptor for 401 handling with refresh\nthis.client.interceptors.response.use(response=>response,async error=>{var _originalRequest$url,_originalRequest$url2,_error$response;const originalRequest=error.config;const isAuthEndpoint=(_originalRequest$url=originalRequest.url)===null||_originalRequest$url===void 0?void 0:_originalRequest$url.includes('/auth/');// Handle 401 Unauthorized (but skip refresh for auth endpoints to avoid loops)\n// Also skip if the request is to /auth/signin - let it fail normally with the error message\nconst isSignInEndpoint=(_originalRequest$url2=originalRequest.url)===null||_originalRequest$url2===void 0?void 0:_originalRequest$url2.includes('/auth/signin');if(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===401&&!originalRequest._retry&&!isAuthEndpoint&&!isSignInEndpoint){// If we're already refreshing, queue this request\nif(this.isRefreshing){return new Promise((resolve,reject)=>{this.failedQueue.push({resolve,reject});}).then(()=>{return this.client(originalRequest);}).catch(err=>{return Promise.reject(err);});}originalRequest._retry=true;this.isRefreshing=true;try{// Attempt to refresh the token using fetch to ensure credentials are included\n// Use fetch directly for refresh to avoid axios interceptor loops\nconst refreshResponse=await fetch(\"\".concat(this.baseURL,\"/auth/refresh\"),{method:'POST',credentials:'include',headers:{'Content-Type':'application/json'}});if(!refreshResponse.ok){throw new Error(\"Refresh failed with status \".concat(refreshResponse.status));}// Process queued requests\nthis.failedQueue.forEach(prom=>prom.resolve());this.failedQueue=[];// Retry the original request with withCredentials ensured\noriginalRequest.withCredentials=true;return this.client(originalRequest);}catch(refreshError){// Refresh failed - clear queue and reject\nthis.failedQueue.forEach(prom=>prom.reject(refreshError));this.failedQueue=[];// Notify auth context about auth failure\nif(this.onAuthFailure){this.onAuthFailure();}return Promise.reject(refreshError);}finally{this.isRefreshing=false;}}// Handle network vs CORS errors so offline issues don't show generic CORS message\nif(error.code==='ERR_NETWORK'||error.message==='Network Error'){const isBrowser=typeof window!=='undefined';const isOffline=isBrowser&&typeof navigator!=='undefined'&&navigator.onLine===false;const looksLikeCors=!isOffline&&!error.response&&error.request&&(error.request.status===0||error.request.readyState===4);if(isOffline){const offlineError=new Error('Network Error: Unable to reach the API. Please check your internet connection or whether the server is down.');offlineError.name='NetworkOfflineError';return Promise.reject(offlineError);}if(looksLikeCors){const frontendOrigin=isBrowser?window.location.origin:'unknown';const corsError=new Error('CORS Error: The API server is not allowing requests from this origin. '+\"Please ensure the backend CORS configuration includes: \".concat(frontendOrigin));corsError.name='CORSError';console.error('CORS Error Details:',{frontendOrigin,apiUrl:this.baseURL,error:error.message});return Promise.reject(corsError);}}return Promise.reject(error);});}// Authentication\nasync signIn(credentials){var _credentials$password,_credentials$email,_credentials$password2,_credentials$password3;// Log the request for debugging\nconsole.log('Signing in with credentials:',{email:credentials.email,passwordLength:(_credentials$password=credentials.password)===null||_credentials$password===void 0?void 0:_credentials$password.length,emailTrimmed:(_credentials$email=credentials.email)===null||_credentials$email===void 0?void 0:_credentials$email.trim(),passwordTrimmed:(_credentials$password2=credentials.password)===null||_credentials$password2===void 0?void 0:(_credentials$password3=_credentials$password2.trim())===null||_credentials$password3===void 0?void 0:_credentials$password3.length});// Trim email and password to avoid whitespace issues\nconst trimmedCredentials={email:credentials.email.trim(),password:credentials.password.trim()};try{// Cookies are set by the backend automatically\nconsole.log('Making signin request...',{url:\"\".concat(this.baseURL,\"/auth/signin\"),method:'POST',withCredentials:true,data:{email:trimmedCredentials.email,passwordLength:trimmedCredentials.password.length}});const response=await this.client.post('/auth/signin',trimmedCredentials);// Check for Set-Cookie headers (axios may not expose these directly)\nconst setCookieHeaders=response.headers['set-cookie'];const hasSetCookieHeaders=!!setCookieHeaders&&(Array.isArray(setCookieHeaders)?setCookieHeaders.length>0:true);console.log('‚úÖ Sign in response received:',{status:response.status,statusText:response.statusText,hasSetCookieHeaders:hasSetCookieHeaders,contentType:response.headers['content-type']});// Check if Set-Cookie headers are present (note: axios may not expose Set-Cookie in headers)\n// Check browser DevTools Network tab ‚Üí Response Headers to verify Set-Cookie headers\nconsole.log('üìã Next step: Check Network tab ‚Üí /auth/signin ‚Üí Response Headers ‚Üí Set-Cookie');console.log('üìã Then check: Next request ‚Üí Request Headers ‚Üí Cookie: header should contain tokens');// Return response data in case it contains user info\nreturn response.data;}catch(error){var _error$response2,_error$response3,_error$response4,_error$config,_error$config2,_error$config3,_error$config4,_error$config4$data,_error$config5,_error$config5$data,_error$config5$data$p,_error$config6,_error$request,_error$request2;console.error('‚ùå Sign in error:',{status:(_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.status,statusText:(_error$response3=error.response)===null||_error$response3===void 0?void 0:_error$response3.statusText,data:(_error$response4=error.response)===null||_error$response4===void 0?void 0:_error$response4.data,message:error.message,code:error.code,config:{url:(_error$config=error.config)===null||_error$config===void 0?void 0:_error$config.url,method:(_error$config2=error.config)===null||_error$config2===void 0?void 0:_error$config2.method,withCredentials:(_error$config3=error.config)===null||_error$config3===void 0?void 0:_error$config3.withCredentials,data:{email:(_error$config4=error.config)===null||_error$config4===void 0?void 0:(_error$config4$data=_error$config4.data)===null||_error$config4$data===void 0?void 0:_error$config4$data.email,passwordLength:(_error$config5=error.config)===null||_error$config5===void 0?void 0:(_error$config5$data=_error$config5.data)===null||_error$config5$data===void 0?void 0:(_error$config5$data$p=_error$config5$data.password)===null||_error$config5$data$p===void 0?void 0:_error$config5$data$p.length},headers:(_error$config6=error.config)===null||_error$config6===void 0?void 0:_error$config6.headers},request:{responseURL:(_error$request=error.request)===null||_error$request===void 0?void 0:_error$request.responseURL,status:(_error$request2=error.request)===null||_error$request2===void 0?void 0:_error$request2.status}});throw error;}}async refresh(){// Use fetch directly to ensure credentials are always included\nconst response=await fetch(\"\".concat(this.baseURL,\"/auth/refresh\"),{method:'POST',credentials:'include',headers:{'Content-Type':'application/json'}});if(!response.ok){throw new Error(\"Refresh failed with status \".concat(response.status));}}async getMe(){try{console.log('üîç Getting user info from /auth/me...');const response=await this.client.get('/auth/me');console.log('‚úÖ /auth/me successful:',response.data);return response.data;}catch(error){var _error$response5,_error$response6,_error$response7;console.error('‚ùå /auth/me failed:',{status:(_error$response5=error.response)===null||_error$response5===void 0?void 0:_error$response5.status,statusText:(_error$response6=error.response)===null||_error$response6===void 0?void 0:_error$response6.statusText,data:(_error$response7=error.response)===null||_error$response7===void 0?void 0:_error$response7.data,message:error.message});console.error('‚ö†Ô∏è Check Network tab ‚Üí /auth/me request ‚Üí Request Headers ‚Üí Cookie: header');console.error('‚ö†Ô∏è If Cookie: header is missing, cookies are not being sent');throw error;}}async debugCookies(){try{const response=await this.client.get('/auth/debug-cookies');return response.data;}catch(error){var _error$response8;console.error('Debug cookies error:',error);return{error:((_error$response8=error.response)===null||_error$response8===void 0?void 0:_error$response8.data)||error.message};}}async updatePassword(passwordData){await this.client.put('/auth/update-password',passwordData);}async logout(){try{await this.client.post('/auth/logout');}catch(error){// Even if logout fails, we should clear local state\nconsole.warn('Logout endpoint failed:',error.message);}}// Cards\nasync createCard(card){try{const response=await this.client.post('/cards/',card);return response.data;}catch(error){var _error$response9,_error$response0,_error$config7;// Log detailed error information for debugging\nconsole.error('createCard error details:',{url:\"\".concat(this.baseURL,\"/cards/\"),method:'POST',data:card,errorCode:error.code,errorMessage:error.message,responseStatus:(_error$response9=error.response)===null||_error$response9===void 0?void 0:_error$response9.status,responseData:(_error$response0=error.response)===null||_error$response0===void 0?void 0:_error$response0.data,requestHeaders:(_error$config7=error.config)===null||_error$config7===void 0?void 0:_error$config7.headers});throw error;}}async getCards(params){const response=await this.client.get('/cards/',{params});return response.data;}async getCard(id){const response=await this.client.get(\"/cards/\".concat(id));return response.data;}async updateCard(id,card){const response=await this.client.patch(\"/cards/\".concat(id),card);return response.data;}async aiEnrichCard(id,data){const response=await this.client.patch(\"/cards/\".concat(id,\"/ai-enrich\"),data);return response.data;}async createAICard(data){const response=await this.client.post('/cards/ai-card',data);return response.data;}async deleteCard(id){const callId=Math.random().toString(36).substr(2,9);console.log(\"[\".concat(callId,\"] API: DELETE /cards/\").concat(id));try{await this.client.delete(\"/cards/\".concat(id));console.log(\"[\".concat(callId,\"] API: Successfully deleted card \").concat(id));}catch(error){var _error$response1;console.error(\"[\".concat(callId,\"] API: Failed to delete card \").concat(id,\":\"),((_error$response1=error.response)===null||_error$response1===void 0?void 0:_error$response1.data)||error.message);throw error;}}async deleteCardBulk(id){const callId=Math.random().toString(36).substr(2,9);console.log(\"[\".concat(callId,\"] API: DELETE /cards/\").concat(id,\"/bulk\"));try{await this.client.delete(\"/cards/\".concat(id,\"/bulk\"));console.log(\"[\".concat(callId,\"] API: Successfully bulk deleted card \").concat(id));}catch(error){var _error$response10;console.error(\"[\".concat(callId,\"] API: Failed to bulk delete card \").concat(id,\":\"),((_error$response10=error.response)===null||_error$response10===void 0?void 0:_error$response10.data)||error.message);throw error;}}async moveCard(id,data){await this.client.patch(\"/cards/\".concat(id,\"/move\"),data);}async getCardsByParent(parentId,params){const response=await this.client.get(\"/cards/by-parent/\".concat(parentId),{params});return response.data;}async getCardsHierarchy(categoryId){const params=categoryId?{category_id:categoryId}:{};const response=await this.client.get('/cards/hierarchy',{params});return response.data;}// Categories\nasync getCategories(){const response=await this.client.get('/categories/');return response.data.items;}async createCategory(name){const response=await this.client.post('/categories/',{name});return response.data;}async updateCategory(id,category){const response=await this.client.patch(\"/categories/\".concat(id),category);return response.data;}async generateAITree(data){const response=await this.client.post('/categories/ai-generate-tree',data);return response.data;}async bulkDeleteCategory(id){console.log(\"API: POST /categories/bulk-delete with category_id: \".concat(id));try{await this.client.post(\"/categories/bulk-delete\",{category_id:id});console.log(\"API: Successfully bulk deleted category \".concat(id));}catch(error){var _error$response11;console.error(\"API: Failed to bulk delete category \".concat(id,\":\"),((_error$response11=error.response)===null||_error$response11===void 0?void 0:_error$response11.data)||error.message);throw error;}}async evaluateMeaning(data){const response=await this.client.post('/cards/evaluate-meaning',data);return response.data;}async evaluateExamplePhrase(data){const response=await this.client.post('/cards/evaluate-example-phrase',data);return response.data;}// No token storage methods needed - using HTTP-only cookies\n}export const apiClient=new ApiClient();export default apiClient;","map":{"version":3,"names":["axios","ApiClient","setOnAuthFailure","callback","onAuthFailure","constructor","_process$env$REACT_AP","baseURL","arguments","length","undefined","process","env","REACT_APP_API_URL","client","isRefreshing","failedQueue","sanitizedEnv","trim","deprecatedHosts","includes","console","warn","window","log","envValue","finalBaseURL","create","headers","withCredentials","xsrfCookieName","xsrfHeaderName","interceptors","request","use","config","_config$url","_config$method2","_config$url2","error","url","_config$method","concat","method","toUpperCase","Object","keys","note","data","Promise","reject","response","_originalRequest$url","_originalRequest$url2","_error$response","originalRequest","isAuthEndpoint","isSignInEndpoint","status","_retry","resolve","push","then","catch","err","refreshResponse","fetch","credentials","ok","Error","forEach","prom","refreshError","code","message","isBrowser","isOffline","navigator","onLine","looksLikeCors","readyState","offlineError","name","frontendOrigin","location","origin","corsError","apiUrl","signIn","_credentials$password","_credentials$email","_credentials$password2","_credentials$password3","email","passwordLength","password","emailTrimmed","passwordTrimmed","trimmedCredentials","post","setCookieHeaders","hasSetCookieHeaders","Array","isArray","statusText","contentType","_error$response2","_error$response3","_error$response4","_error$config","_error$config2","_error$config3","_error$config4","_error$config4$data","_error$config5","_error$config5$data","_error$config5$data$p","_error$config6","_error$request","_error$request2","responseURL","refresh","getMe","get","_error$response5","_error$response6","_error$response7","debugCookies","_error$response8","updatePassword","passwordData","put","logout","createCard","card","_error$response9","_error$response0","_error$config7","errorCode","errorMessage","responseStatus","responseData","requestHeaders","getCards","params","getCard","id","updateCard","patch","aiEnrichCard","createAICard","deleteCard","callId","Math","random","toString","substr","delete","_error$response1","deleteCardBulk","_error$response10","moveCard","getCardsByParent","parentId","getCardsHierarchy","categoryId","category_id","getCategories","items","createCategory","updateCategory","category","generateAITree","bulkDeleteCategory","_error$response11","evaluateMeaning","evaluateExamplePhrase","apiClient"],"sources":["/Users/tassiobs/Documents/vocatree-fe/src/services/api.ts"],"sourcesContent":["import axios, { AxiosInstance, AxiosResponse, InternalAxiosRequestConfig } from 'axios';\nimport {\n  AuthSignInRequest,\n  AuthToken,\n  AuthUpdatePasswordRequest,\n  AuthMeResponse,\n  Card,\n  CardCreate,\n  CardUpdate,\n  CardAIEnrichRequest,\n  CardListResponse,\n  Category,\n  CategoryListResponse,\n  CategoryUpdate,\n  EvaluateMeaningRequest,\n  EvaluateMeaningResponse,\n  EvaluateExamplePhraseRequest,\n  EvaluateExamplePhraseResponse\n} from '../types/api';\n\nclass ApiClient {\n  private client: AxiosInstance;\n  private baseURL: string;\n  private isRefreshing: boolean = false;\n  private failedQueue: Array<{\n    resolve: (value?: any) => void;\n    reject: (reason?: any) => void;\n  }> = [];\n  private onAuthFailure?: () => void;\n\n  setOnAuthFailure(callback: () => void) {\n    this.onAuthFailure = callback;\n  }\n\n  constructor(baseURL: string = process.env.REACT_APP_API_URL || 'https://web-production-89a2.up.railway.app/') {\n    const sanitizedEnv = process.env.REACT_APP_API_URL?.trim();\n    const deprecatedHosts = ['https://vocatree-production-17ae.up.railway.app', 'https://vocatree-production-17ae.up.railway.app/'];\n    if (sanitizedEnv && deprecatedHosts.includes(sanitizedEnv)) {\n      console.warn('Detected deprecated REACT_APP_API_URL value, overriding to new production host.');\n      baseURL = 'https://web-production-89a2.up.railway.app/';\n    }\n    this.baseURL = baseURL;\n    if (typeof window !== 'undefined') {\n      console.log('ApiClient baseURL resolved:', {\n        envValue: process.env.REACT_APP_API_URL,\n        finalBaseURL: this.baseURL,\n      });\n    }\n    this.client = axios.create({\n      baseURL: this.baseURL,\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      withCredentials: true, // REQUIRED: Send cookies with all requests (cross-origin)\n      xsrfCookieName: undefined, // Disable CSRF token handling - not needed for our use case\n      xsrfHeaderName: undefined,\n    });\n\n    // Request interceptor - ensure withCredentials is always true\n    this.client.interceptors.request.use(\n      (config) => {\n        // CRITICAL: Ensure withCredentials is always set to true for cookie-based auth\n        // This is required for cross-origin cookie support\n        config.withCredentials = true;\n        \n        // Log if withCredentials somehow got disabled\n        if (!config.withCredentials) {\n          console.error('‚ö†Ô∏è WARNING: withCredentials was false! Forcing to true.');\n        }\n        \n        // Log auth-related requests for debugging\n        if (config.url?.includes('/auth/')) {\n          console.log('üîê Auth request:', {\n            url: `${this.baseURL}${config.url}`,\n            method: config.method?.toUpperCase(),\n            withCredentials: config.withCredentials,\n            headers: Object.keys(config.headers || {}),\n            // Note: HttpOnly cookies won't appear in document.cookie, but should be sent automatically\n            note: 'HttpOnly cookies are sent automatically if withCredentials is true',\n          });\n        }\n        \n        // Log request details for debugging\n        if (config.method?.toUpperCase() === 'POST' && config.url?.includes('/cards/')) {\n          console.log('POST /cards/ request:', {\n            url: `${this.baseURL}${config.url}`,\n            method: config.method,\n            headers: config.headers,\n            data: config.data,\n            withCredentials: config.withCredentials,\n          });\n        }\n        return config;\n      },\n      (error) => {\n        return Promise.reject(error);\n      }\n    );\n\n    // Response interceptor for 401 handling with refresh\n    this.client.interceptors.response.use(\n      (response) => response,\n      async (error) => {\n        const originalRequest = error.config as InternalAxiosRequestConfig & { _retry?: boolean };\n        const isAuthEndpoint = originalRequest.url?.includes('/auth/');\n\n        // Handle 401 Unauthorized (but skip refresh for auth endpoints to avoid loops)\n        // Also skip if the request is to /auth/signin - let it fail normally with the error message\n        const isSignInEndpoint = originalRequest.url?.includes('/auth/signin');\n        if (error.response?.status === 401 && !originalRequest._retry && !isAuthEndpoint && !isSignInEndpoint) {\n          // If we're already refreshing, queue this request\n          if (this.isRefreshing) {\n            return new Promise((resolve, reject) => {\n              this.failedQueue.push({ resolve, reject });\n            })\n              .then(() => {\n                return this.client(originalRequest);\n              })\n              .catch((err) => {\n                return Promise.reject(err);\n              });\n          }\n\n          originalRequest._retry = true;\n          this.isRefreshing = true;\n\n          try {\n            // Attempt to refresh the token using fetch to ensure credentials are included\n            // Use fetch directly for refresh to avoid axios interceptor loops\n            const refreshResponse = await fetch(`${this.baseURL}/auth/refresh`, {\n              method: 'POST',\n              credentials: 'include',\n              headers: {\n                'Content-Type': 'application/json',\n              },\n            });\n            \n            if (!refreshResponse.ok) {\n              throw new Error(`Refresh failed with status ${refreshResponse.status}`);\n            }\n            \n            // Process queued requests\n            this.failedQueue.forEach((prom) => prom.resolve());\n            this.failedQueue = [];\n            \n            // Retry the original request with withCredentials ensured\n            originalRequest.withCredentials = true;\n            return this.client(originalRequest);\n          } catch (refreshError) {\n            // Refresh failed - clear queue and reject\n            this.failedQueue.forEach((prom) => prom.reject(refreshError));\n            this.failedQueue = [];\n            \n            // Notify auth context about auth failure\n            if (this.onAuthFailure) {\n              this.onAuthFailure();\n            }\n            \n            return Promise.reject(refreshError);\n          } finally {\n            this.isRefreshing = false;\n          }\n        }\n\n        // Handle network vs CORS errors so offline issues don't show generic CORS message\n        if (error.code === 'ERR_NETWORK' || error.message === 'Network Error') {\n          const isBrowser = typeof window !== 'undefined';\n          const isOffline = isBrowser && typeof navigator !== 'undefined' && navigator.onLine === false;\n          const looksLikeCors =\n            !isOffline &&\n            !error.response &&\n            error.request &&\n            (error.request.status === 0 || error.request.readyState === 4);\n\n          if (isOffline) {\n            const offlineError = new Error(\n              'Network Error: Unable to reach the API. Please check your internet connection or whether the server is down.'\n            );\n            offlineError.name = 'NetworkOfflineError';\n            return Promise.reject(offlineError);\n          }\n\n          if (looksLikeCors) {\n            const frontendOrigin = isBrowser ? window.location.origin : 'unknown';\n            const corsError = new Error(\n              'CORS Error: The API server is not allowing requests from this origin. ' +\n              `Please ensure the backend CORS configuration includes: ${frontendOrigin}`\n            );\n            corsError.name = 'CORSError';\n            console.error('CORS Error Details:', {\n              frontendOrigin,\n              apiUrl: this.baseURL,\n              error: error.message\n            });\n            return Promise.reject(corsError);\n          }\n        }\n\n        return Promise.reject(error);\n      }\n    );\n  }\n\n  // Authentication\n  async signIn(credentials: AuthSignInRequest): Promise<any> {\n    // Log the request for debugging\n    console.log('Signing in with credentials:', {\n      email: credentials.email,\n      passwordLength: credentials.password?.length,\n      emailTrimmed: credentials.email?.trim(),\n      passwordTrimmed: credentials.password?.trim()?.length,\n    });\n    \n    // Trim email and password to avoid whitespace issues\n    const trimmedCredentials: AuthSignInRequest = {\n      email: credentials.email.trim(),\n      password: credentials.password.trim(),\n    };\n    \n    try {\n      // Cookies are set by the backend automatically\n      console.log('Making signin request...', {\n        url: `${this.baseURL}/auth/signin`,\n        method: 'POST',\n        withCredentials: true,\n        data: {\n          email: trimmedCredentials.email,\n          passwordLength: trimmedCredentials.password.length,\n        },\n      });\n      \n      const response = await this.client.post('/auth/signin', trimmedCredentials);\n      \n      // Check for Set-Cookie headers (axios may not expose these directly)\n      const setCookieHeaders = response.headers['set-cookie'];\n      const hasSetCookieHeaders = !!setCookieHeaders && (Array.isArray(setCookieHeaders) ? setCookieHeaders.length > 0 : true);\n      \n      console.log('‚úÖ Sign in response received:', {\n        status: response.status,\n        statusText: response.statusText,\n        hasSetCookieHeaders: hasSetCookieHeaders,\n        contentType: response.headers['content-type'],\n      });\n      \n      // Check if Set-Cookie headers are present (note: axios may not expose Set-Cookie in headers)\n      // Check browser DevTools Network tab ‚Üí Response Headers to verify Set-Cookie headers\n      console.log('üìã Next step: Check Network tab ‚Üí /auth/signin ‚Üí Response Headers ‚Üí Set-Cookie');\n      console.log('üìã Then check: Next request ‚Üí Request Headers ‚Üí Cookie: header should contain tokens');\n      \n      // Return response data in case it contains user info\n      return response.data;\n    } catch (error: any) {\n      console.error('‚ùå Sign in error:', {\n        status: error.response?.status,\n        statusText: error.response?.statusText,\n        data: error.response?.data,\n        message: error.message,\n        code: error.code,\n        config: {\n          url: error.config?.url,\n          method: error.config?.method,\n          withCredentials: error.config?.withCredentials,\n          data: {\n            email: error.config?.data?.email,\n            passwordLength: error.config?.data?.password?.length,\n          },\n          headers: error.config?.headers,\n        },\n        request: {\n          responseURL: error.request?.responseURL,\n          status: error.request?.status,\n        },\n      });\n      throw error;\n    }\n  }\n\n  async refresh(): Promise<void> {\n    // Use fetch directly to ensure credentials are always included\n    const response = await fetch(`${this.baseURL}/auth/refresh`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    });\n    \n    if (!response.ok) {\n      throw new Error(`Refresh failed with status ${response.status}`);\n    }\n  }\n\n  async getMe(): Promise<AuthMeResponse> {\n    try {\n      console.log('üîç Getting user info from /auth/me...');\n      const response: AxiosResponse<AuthMeResponse> = await this.client.get('/auth/me');\n      console.log('‚úÖ /auth/me successful:', response.data);\n      return response.data;\n    } catch (error: any) {\n      console.error('‚ùå /auth/me failed:', {\n        status: error.response?.status,\n        statusText: error.response?.statusText,\n        data: error.response?.data,\n        message: error.message,\n      });\n      console.error('‚ö†Ô∏è Check Network tab ‚Üí /auth/me request ‚Üí Request Headers ‚Üí Cookie: header');\n      console.error('‚ö†Ô∏è If Cookie: header is missing, cookies are not being sent');\n      throw error;\n    }\n  }\n\n  async debugCookies(): Promise<any> {\n    try {\n      const response: AxiosResponse<any> = await this.client.get('/auth/debug-cookies');\n      return response.data;\n    } catch (error: any) {\n      console.error('Debug cookies error:', error);\n      return { error: error.response?.data || error.message };\n    }\n  }\n\n  async updatePassword(passwordData: AuthUpdatePasswordRequest): Promise<void> {\n    await this.client.put('/auth/update-password', passwordData);\n  }\n\n  async logout(): Promise<void> {\n    try {\n      await this.client.post('/auth/logout');\n    } catch (error: any) {\n      // Even if logout fails, we should clear local state\n      console.warn('Logout endpoint failed:', error.message);\n    }\n  }\n\n  // Cards\n  async createCard(card: CardCreate): Promise<Card> {\n    try {\n      const response: AxiosResponse<Card> = await this.client.post('/cards/', card);\n      return response.data;\n    } catch (error: any) {\n      // Log detailed error information for debugging\n      console.error('createCard error details:', {\n        url: `${this.baseURL}/cards/`,\n        method: 'POST',\n        data: card,\n        errorCode: error.code,\n        errorMessage: error.message,\n        responseStatus: error.response?.status,\n        responseData: error.response?.data,\n        requestHeaders: error.config?.headers,\n      });\n      throw error;\n    }\n  }\n\n  async getCards(params?: {\n    parent_id?: number | null;\n    limit?: number;\n    offset?: number;\n  }): Promise<CardListResponse> {\n    const response: AxiosResponse<CardListResponse> = await this.client.get('/cards/', { params });\n    return response.data;\n  }\n\n  async getCard(id: number): Promise<Card> {\n    const response: AxiosResponse<Card> = await this.client.get(`/cards/${id}`);\n    return response.data;\n  }\n\n  async updateCard(id: number, card: CardUpdate): Promise<Card> {\n    const response: AxiosResponse<Card> = await this.client.patch(`/cards/${id}`, card);\n    return response.data;\n  }\n\n  async aiEnrichCard(id: number, data: CardAIEnrichRequest): Promise<Card> {\n    const response: AxiosResponse<Card> = await this.client.patch(`/cards/${id}/ai-enrich`, data);\n    return response.data;\n  }\n\n  async createAICard(data: {\n    name: string;\n    language: string;\n    prompt?: string;\n    category_id?: number;\n    parent_id?: number;\n  }): Promise<Card> {\n    const response: AxiosResponse<Card> = await this.client.post('/cards/ai-card', data);\n    return response.data;\n  }\n\n  async deleteCard(id: number): Promise<void> {\n    const callId = Math.random().toString(36).substr(2, 9);\n    console.log(`[${callId}] API: DELETE /cards/${id}`);\n    try {\n      await this.client.delete(`/cards/${id}`);\n      console.log(`[${callId}] API: Successfully deleted card ${id}`);\n    } catch (error: any) {\n      console.error(`[${callId}] API: Failed to delete card ${id}:`, error.response?.data || error.message);\n      throw error;\n    }\n  }\n\n  async deleteCardBulk(id: number): Promise<void> {\n    const callId = Math.random().toString(36).substr(2, 9);\n    console.log(`[${callId}] API: DELETE /cards/${id}/bulk`);\n    try {\n      await this.client.delete(`/cards/${id}/bulk`);\n      console.log(`[${callId}] API: Successfully bulk deleted card ${id}`);\n    } catch (error: any) {\n      console.error(`[${callId}] API: Failed to bulk delete card ${id}:`, error.response?.data || error.message);\n      throw error;\n    }\n  }\n\n  async moveCard(id: number, data: { parent_id?: number | null; category_id?: number | null }): Promise<void> {\n    await this.client.patch(`/cards/${id}/move`, data);\n  }\n\n  async getCardsByParent(parentId: number, params?: {\n    limit?: number;\n    offset?: number;\n  }): Promise<CardListResponse> {\n    const response: AxiosResponse<CardListResponse> = await this.client.get(\n      `/cards/by-parent/${parentId}`,\n      { params }\n    );\n    return response.data;\n  }\n\n  async getCardsHierarchy(categoryId?: number): Promise<Card[]> {\n    const params = categoryId ? { category_id: categoryId } : {};\n    const response: AxiosResponse<Card[]> = await this.client.get('/cards/hierarchy', { params });\n    return response.data;\n  }\n\n  // Categories\n  async getCategories(): Promise<Category[]> {\n    const response: AxiosResponse<CategoryListResponse> = await this.client.get('/categories/');\n    return response.data.items;\n  }\n\n  async createCategory(name: string): Promise<Category> {\n    const response: AxiosResponse<Category> = await this.client.post('/categories/', { name });\n    return response.data;\n  }\n\n  async updateCategory(id: number, category: CategoryUpdate): Promise<Category> {\n    const response: AxiosResponse<Category> = await this.client.patch(`/categories/${id}`, category);\n    return response.data;\n  }\n\n  async generateAITree(data: {\n    language: string;\n    category_name: string;\n    prompt?: string;\n  }): Promise<any> {\n    const response: AxiosResponse<any> = await this.client.post('/categories/ai-generate-tree', data);\n    return response.data;\n  }\n\n  async bulkDeleteCategory(id: number): Promise<void> {\n    console.log(`API: POST /categories/bulk-delete with category_id: ${id}`);\n    try {\n      await this.client.post(`/categories/bulk-delete`, { category_id: id });\n      console.log(`API: Successfully bulk deleted category ${id}`);\n    } catch (error: any) {\n      console.error(`API: Failed to bulk delete category ${id}:`, error.response?.data || error.message);\n      throw error;\n    }\n  }\n\n  async evaluateMeaning(data: EvaluateMeaningRequest): Promise<EvaluateMeaningResponse> {\n    const response: AxiosResponse<EvaluateMeaningResponse> = await this.client.post('/cards/evaluate-meaning', data);\n    return response.data;\n  }\n\n  async evaluateExamplePhrase(data: EvaluateExamplePhraseRequest): Promise<EvaluateExamplePhraseResponse> {\n    const response: AxiosResponse<EvaluateExamplePhraseResponse> = await this.client.post('/cards/evaluate-example-phrase', data);\n    return response.data;\n  }\n\n  // No token storage methods needed - using HTTP-only cookies\n}\n\nexport const apiClient = new ApiClient();\nexport default apiClient;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}