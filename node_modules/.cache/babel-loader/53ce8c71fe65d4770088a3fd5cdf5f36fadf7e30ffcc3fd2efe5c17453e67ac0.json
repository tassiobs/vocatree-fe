{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import{AddItemInput}from'./AddItemInput';import{CardDetail}from'./CardDetail';import{UpdateCardAI}from'./UpdateCardAI';import{AICardForm}from'./AICardForm';import{PracticeCard}from'./PracticeCard';import{FolderView}from'./FolderView';import{MoveToModal}from'./MoveToModal';import{DropdownMenu,createEditAction,createDeleteAction,createAICardAction,createPracticeCardAction}from'./DropdownMenu';import{handleConditionalDelete}from'../utils/deleteUtils';import{apiClient}from'../services/api';import{ChevronRight,ChevronDown,Folder,FileText,Plus,GripVertical,Hash,Sparkles,Move}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export const TreeNode=_ref=>{let{item,onToggle,onRename,onDelete,onAddChild,onMove,level,categoryId,categories=[]}=_ref;const[isEditing,setIsEditing]=useState(false);const[editName,setEditName]=useState(item.name);const[showAddInput,setShowAddInput]=useState(false);const[addType,setAddType]=useState('card');const[showDetail,setShowDetail]=useState(false);const[showUpdateAI,setShowUpdateAI]=useState(false);const[showAICardForm,setShowAICardForm]=useState(false);const[showPracticeCard,setShowPracticeCard]=useState(false);const[newCardId,setNewCardId]=useState(null);const[showFolderView,setShowFolderView]=useState(false);const[showMoveToModal,setShowMoveToModal]=useState(false);// Drag and drop state\nconst[isDragging,setIsDragging]=useState(false);const[dragOver,setDragOver]=useState(false);const[isDragTarget,setIsDragTarget]=useState(false);const nodeRef=useRef(null);const longPressTimer=useRef(null);const draggedItemRef=useRef(null);const isMobile=typeof window!=='undefined'&&window.innerWidth<768;const handleRename=()=>{if(editName.trim()&&editName.trim()!==item.name){onRename(item.id,editName.trim());}setIsEditing(false);};const handleCancelEdit=()=>{setEditName(item.name);setIsEditing(false);};const handleKeyDown=e=>{if(e.key==='Enter'){handleRename();}else if(e.key==='Escape'){handleCancelEdit();}};const handleAddChild=name=>{onAddChild(item.id,addType,name);setShowAddInput(false);};const handleAddFolder=()=>{setAddType('folder');setShowAddInput(true);};const handleAddCard=()=>{setAddType('card');setShowAddInput(true);};const handleCardClick=()=>{if(!isEditing){setShowDetail(true);}};const handleFolderClick=()=>{if(!isEditing&&item.is_folder){setShowFolderView(true);}};const handleDetailClose=()=>{setShowDetail(false);};const handleDetailSave=()=>{// Refresh the parent tree to show updated data\nwindow.location.reload();};const handleAICardSuccess=cardId=>{setShowAICardForm(false);// Open the card detail view immediately to show the created card data\nsetNewCardId(cardId);};const handleNewCardDetailClose=()=>{setNewCardId(null);// Refresh the tree after closing to show the new card in the tree\nwindow.location.reload();};const handleNewCardDetailSave=()=>{// Refresh the parent tree to show updated data\nwindow.location.reload();};// Check if target folder is a subfolder (has a parent_id)\nconst isTargetSubfolder=targetItem=>{return targetItem.parent_id!==null&&targetItem.parent_id!==undefined;};// Drag handlers\nconst handleDragStart=e=>{if(isEditing){e.preventDefault();return;}setIsDragging(true);e.dataTransfer.effectAllowed='move';const dragData={id:item.id,type:item.type,parent_id:item.parent_id,category_id:item.category_id};e.dataTransfer.setData('application/json',JSON.stringify(dragData));draggedItemRef.current=item;// Add visual feedback\nif(e.currentTarget instanceof HTMLElement){e.currentTarget.style.opacity='0.5';}};const handleDragEnd=e=>{setIsDragging(false);setDragOver(false);draggedItemRef.current=null;if(e.currentTarget instanceof HTMLElement){e.currentTarget.style.opacity='1';}};const handleDragOver=e=>{e.preventDefault();e.stopPropagation();// Check if this is a valid drop target\nif(item.is_folder&&draggedItemRef.current){// Validate if dragged item can be moved to this folder\nif(canMoveToTarget(draggedItemRef.current,item)){e.dataTransfer.dropEffect='move';setDragOver(true);setIsDragTarget(true);}else{e.dataTransfer.dropEffect='none';setDragOver(false);setIsDragTarget(false);}}else if(!item.is_folder){e.dataTransfer.dropEffect='none';setDragOver(false);setIsDragTarget(false);}};const handleDragLeave=e=>{e.preventDefault();setDragOver(false);setIsDragTarget(false);};const handleDrop=async e=>{e.preventDefault();e.stopPropagation();setDragOver(false);setIsDragTarget(false);try{const dragData=JSON.parse(e.dataTransfer.getData('application/json'));const draggedItem={id:dragData.id,type:dragData.type,parent_id:dragData.parent_id,is_folder:dragData.type==='folder',children:[]};if(draggedItem.id===item.id||!item.is_folder)return;// Validate move\nif(!canMoveToTarget(draggedItem,item)){alert('Cannot move here. Subfolders cannot contain other folders.');return;}// Move to this folder\nawait onMove(draggedItem.id,{parent_id:item.id});}catch(err){var _err$response,_err$response$data;console.error('Error handling drop:',err);alert(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.detail)||'Failed to move item');}};// Check if dragged item can be moved to target\nconst canMoveToTarget=(draggedItem,targetItem)=>{// Can't move to itself\nif(draggedItem.id===targetItem.id)return false;// Can't move to its own children (prevent circular reference)\nconst isDescendant=(parent,childId)=>{if(parent.id===childId)return true;return parent.children.some(child=>isDescendant(child,childId));};if(isDescendant(draggedItem,targetItem.id))return false;// Folders can't be moved into subfolders\nif(draggedItem.is_folder&&targetItem.is_folder&&isTargetSubfolder(targetItem)){return false;}return true;};// Mobile long-press handler\nconst handleTouchStart=e=>{if(isEditing||!isMobile)return;longPressTimer.current=setTimeout(()=>{setIsDragging(true);// Trigger drag on mobile\nconst touch=e.touches[0];const dragEvent=new DragEvent('dragstart',{bubbles:true,cancelable:true});// Note: Touch drag is limited, so we'll use Move To modal instead\n},500);// 500ms long press\n};const handleTouchEnd=()=>{if(longPressTimer.current){clearTimeout(longPressTimer.current);longPressTimer.current=null;}setIsDragging(false);};const handleTouchMove=()=>{if(longPressTimer.current){clearTimeout(longPressTimer.current);longPressTimer.current=null;}};useEffect(()=>{return()=>{if(longPressTimer.current){clearTimeout(longPressTimer.current);}};},[]);// Create dropdown menu items\nconst getDropdownItems=()=>{const items=[createEditAction(()=>setIsEditing(true)),{id:'move',label:'Move To...',icon:/*#__PURE__*/_jsx(Move,{className:\"h-4 w-4\"}),onClick:()=>setShowMoveToModal(true)},createDeleteAction(()=>handleConditionalDelete(item,()=>onDelete(item.id)))];// Add \"Update Card using AI\" and \"Practice card\" actions only for cards (not folders)\nif(!item.is_folder){items.push({id:'update-ai',label:'Update Card using AI',icon:/*#__PURE__*/_jsx(Sparkles,{className:\"h-4 w-4\"}),onClick:()=>setShowUpdateAI(true)});items.push(createPracticeCardAction(()=>setShowPracticeCard(true)));}// Add \"Add a card using AI\" action for folders\nif(item.is_folder){items.push(createAICardAction(()=>setShowAICardForm(true)));}return items;};// Handle AI update success\nconst handleAIUpdateSuccess=async updatedCard=>{setShowUpdateAI(false);// Open the card detail view with updated data\n// The CardDetail component will automatically reload the card data\nsetShowDetail(true);};// Calculate indentation based on level\nconst indentPx=level*24;// Increased from 20px for better visual separation\n// Get item count for folders\nconst itemCount=item.children?item.children.length:0;const hasChildren=item.children&&item.children.length>0;// Different styling based on level and type\nconst isTopLevelFolder=level===0&&item.is_folder;const isSubfolder=level===1&&item.is_folder;const isCard=!item.is_folder;return/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsxs(\"div\",{ref:nodeRef,draggable:!isEditing&&!isMobile,onDragStart:handleDragStart,onDragEnd:handleDragEnd,onDragOver:handleDragOver,onDragLeave:handleDragLeave,onDrop:handleDrop,onTouchStart:isMobile?handleTouchStart:undefined,onTouchEnd:isMobile?handleTouchEnd:undefined,onTouchMove:isMobile?handleTouchMove:undefined,className:\"group transition-all duration-200 \".concat(isTopLevelFolder?'py-3 px-4 bg-blue-50 border-l-4 border-blue-400 rounded-lg mb-2 hover:bg-blue-100':isSubfolder?'py-2 px-3 ml-6 bg-gray-50 border-l-2 border-gray-300 rounded-md mb-1 hover:bg-gray-100':isCard?'py-1.5 px-3 ml-8 hover:bg-gray-50 rounded-md border-l border-gray-200':'py-2 px-3 hover:bg-gray-50 rounded-md',\" \").concat(isDragging?'opacity-50 cursor-grabbing':'cursor-move',\" \").concat(dragOver&&item.is_folder?'bg-green-100 border-green-400 border-2 ring-2 ring-green-300':''),style:{marginLeft:\"\".concat(indentPx,\"px\")},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"hidden lg:flex items-center flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mr-2 transition-opacity \".concat(isMobile?'opacity-50':'opacity-0 group-hover:opacity-100',\" cursor-grab active:cursor-grabbing\"),onMouseDown:e=>e.stopPropagation(),onTouchStart:e=>{e.stopPropagation();if(isMobile){handleTouchStart(e);}},children:/*#__PURE__*/_jsx(GripVertical,{className:\"h-3 w-3 text-gray-400\"})}),hasChildren&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>onToggle(item.id),className:\"mr-2 p-1 hover:bg-gray-200 rounded transition-colors \".concat(isTopLevelFolder?'hover:bg-blue-200':''),children:item.isExpanded?/*#__PURE__*/_jsx(ChevronDown,{className:\"h-4 w-4 text-gray-600\"}):/*#__PURE__*/_jsx(ChevronRight,{className:\"h-4 w-4 text-gray-600\"})}),!hasChildren&&/*#__PURE__*/_jsx(\"div\",{className:\"w-6 mr-2\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mr-3 flex-shrink-0\",children:item.is_folder?/*#__PURE__*/_jsx(Folder,{className:\"\".concat(isTopLevelFolder?'h-5 w-5 text-blue-600':'h-4 w-4 text-blue-500')}):/*#__PURE__*/_jsx(FileText,{className:\"h-3.5 w-3.5 text-gray-500\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 min-w-0\",children:isEditing?/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editName,onChange:e=>setEditName(e.target.value),onBlur:handleRename,onKeyDown:handleKeyDown,className:\"w-full border-0 outline-none bg-transparent \".concat(isTopLevelFolder?'text-lg font-semibold':'text-sm'),autoFocus:true}):/*#__PURE__*/_jsx(\"button\",{onClick:isCard?handleCardClick:handleFolderClick,className:\"truncate text-left w-full transition-colors \".concat(isTopLevelFolder?'text-lg font-semibold text-gray-900 hover:text-blue-700':isSubfolder?'text-sm font-medium text-gray-800 hover:text-blue-600':'text-sm text-gray-600 hover:text-gray-900'),children:item.name})}),item.is_folder&&itemCount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mr-2 flex items-center\",children:[/*#__PURE__*/_jsx(Hash,{className:\"h-3 w-3 text-gray-400 mr-1\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-500\",children:itemCount})]}),item.is_folder&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[item.parent_id===null&&/*#__PURE__*/_jsx(\"button\",{onClick:handleAddFolder,className:\"p-1 hover:bg-blue-100 rounded bg-blue-50\",title:\"Add subfolder\",children:/*#__PURE__*/_jsx(Folder,{className:\"h-3 w-3 text-blue-600\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleAddCard,className:\"p-1 hover:bg-gray-200 rounded bg-gray-100\",title:\"Add card\",children:/*#__PURE__*/_jsx(Plus,{className:\"h-3 w-3 text-gray-700\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"ml-2\",children:/*#__PURE__*/_jsx(DropdownMenu,{items:getDropdownItems(),className:\"opacity-0 group-hover:opacity-100 transition-opacity\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lg:hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mr-2 transition-opacity \".concat(isMobile?'opacity-50':'opacity-0 group-hover:opacity-100',\" cursor-grab active:cursor-grabbing\"),onMouseDown:e=>e.stopPropagation(),onTouchStart:e=>{e.stopPropagation();if(isMobile){handleTouchStart(e);}},children:/*#__PURE__*/_jsx(GripVertical,{className:\"h-3 w-3 text-gray-400\"})}),hasChildren&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>onToggle(item.id),className:\"mr-2 p-1.5 hover:bg-gray-200 rounded transition-colors \".concat(isTopLevelFolder?'hover:bg-blue-200':''),style:{minWidth:'44px',minHeight:'44px'},children:item.isExpanded?/*#__PURE__*/_jsx(ChevronDown,{className:\"h-4 w-4 text-gray-600\"}):/*#__PURE__*/_jsx(ChevronRight,{className:\"h-4 w-4 text-gray-600\"})}),!hasChildren&&/*#__PURE__*/_jsx(\"div\",{className:\"w-6 mr-2\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mr-3 flex-shrink-0\",children:item.is_folder?/*#__PURE__*/_jsx(Folder,{className:\"\".concat(isTopLevelFolder?'h-5 w-5 text-blue-600':'h-4 w-4 text-blue-500')}):/*#__PURE__*/_jsx(FileText,{className:\"h-3.5 w-3.5 text-gray-500\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 min-w-0\",children:isEditing?/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editName,onChange:e=>setEditName(e.target.value),onBlur:handleRename,onKeyDown:handleKeyDown,className:\"w-full border-0 outline-none bg-transparent \".concat(isTopLevelFolder?'text-lg font-semibold':'text-sm'),autoFocus:true}):/*#__PURE__*/_jsx(\"button\",{onClick:isCard?handleCardClick:handleFolderClick,className:\"truncate text-left w-full transition-colors \".concat(isTopLevelFolder?'text-lg font-semibold text-gray-900 hover:text-blue-700':isSubfolder?'text-sm font-medium text-gray-800 hover:text-blue-600':'text-sm text-gray-600 hover:text-gray-900'),children:item.name})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"ml-2 flex-shrink-0\",children:/*#__PURE__*/_jsx(DropdownMenu,{items:getDropdownItems(),className:\"opacity-100\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[item.is_folder&&itemCount>0&&/*#__PURE__*/_jsx(\"div\",{className:\"stats flex items-center space-x-4\",children:((_item$children,_item$children2)=>{const folderCount=((_item$children=item.children)===null||_item$children===void 0?void 0:_item$children.filter(child=>child.is_folder).length)||0;const cardCount=((_item$children2=item.children)===null||_item$children2===void 0?void 0:_item$children2.filter(child=>!child.is_folder).length)||0;return/*#__PURE__*/_jsxs(_Fragment,{children:[folderCount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center bg-blue-50 px-2 py-1 rounded-md\",children:[/*#__PURE__*/_jsx(Folder,{className:\"h-3 w-3 text-blue-600 mr-1\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-medium text-blue-700\",children:folderCount})]}),cardCount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center bg-gray-50 px-2 py-1 rounded-md\",children:[/*#__PURE__*/_jsx(FileText,{className:\"h-3 w-3 text-gray-600 mr-1\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-medium text-gray-700\",children:cardCount})]})]});})()}),item.is_folder&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[item.parent_id===null&&/*#__PURE__*/_jsxs(\"button\",{onClick:handleAddFolder,className:\"px-3 py-2 text-xs font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-md transition-colors\",title:\"Add subfolder\",style:{minHeight:'44px'},children:[/*#__PURE__*/_jsx(Folder,{className:\"h-3 w-3 inline mr-1\"}),\"Add Folder\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleAddCard,className:\"px-3 py-2 text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors\",title:\"Add card\",style:{minHeight:'44px'},children:[/*#__PURE__*/_jsx(Plus,{className:\"h-3 w-3 inline mr-1\"}),\"Add Card\"]})]}),!item.is_folder&&/*#__PURE__*/_jsx(\"div\",{})]})]})]}),showAddInput&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2\",style:{marginLeft:\"\".concat(indentPx+24,\"px\")},children:/*#__PURE__*/_jsx(AddItemInput,{parentId:item.id,type:addType,onSubmit:handleAddChild,onCancel:()=>setShowAddInput(false),placeholder:\"Add \".concat(addType,\"...\")})}),item.isExpanded&&item.children&&item.children.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-1\",children:item.children.map(child=>/*#__PURE__*/_jsx(TreeNode,{item:child,onToggle:onToggle,onRename:onRename,onDelete:onDelete,onAddChild:onAddChild,onMove:onMove,level:level+1},child.id))}),showDetail&&/*#__PURE__*/_jsx(CardDetail,{cardId:item.id,onClose:handleDetailClose,onSave:handleDetailSave}),showUpdateAI&&/*#__PURE__*/_jsx(UpdateCardAIWrapper,{item:item,onClose:()=>setShowUpdateAI(false),onSuccess:handleAIUpdateSuccess}),showAICardForm&&item.is_folder&&/*#__PURE__*/_jsx(AICardForm,{parentId:item.id,parentName:item.name,onClose:()=>setShowAICardForm(false),onSuccess:handleAICardSuccess}),newCardId!==null&&/*#__PURE__*/_jsx(CardDetail,{cardId:newCardId,onClose:handleNewCardDetailClose,onSave:handleNewCardDetailSave}),showPracticeCard&&!item.is_folder&&/*#__PURE__*/_jsx(PracticeCard,{cardId:item.id,onClose:()=>setShowPracticeCard(false)}),showFolderView&&item.is_folder&&/*#__PURE__*/_jsx(FolderView,{folder:item,onClose:()=>setShowFolderView(false),onRename:onRename,onDelete:onDelete,onMove:onMove,categories:categories}),showMoveToModal&&categories.length>0&&/*#__PURE__*/_jsx(MoveToModal,{item:item,categories:categories,onClose:()=>setShowMoveToModal(false),onMove:onMove})]});};// Wrapper component to handle async card conversion\nconst UpdateCardAIWrapper=_ref2=>{let{item,onClose,onSuccess}=_ref2;const[card,setCard]=useState(null);const[isLoading,setIsLoading]=useState(true);React.useEffect(()=>{const loadCard=async()=>{try{const cardData=await apiClient.getCard(item.id);setCard(cardData);}catch(error){var _item$parent_id,_item$category_id,_item$example_phrases,_item$meanings,_item$grammar_roles,_item$collocations,_item$synonyms,_item$antonyms,_item$use_count,_item$notes,_item$created_at;// If fetch fails, create a minimal card object from the item\nconst minimalCard={id:item.id,name:item.name,parent_id:(_item$parent_id=item.parent_id)!==null&&_item$parent_id!==void 0?_item$parent_id:null,is_folder:item.is_folder,category_id:(_item$category_id=item.category_id)!==null&&_item$category_id!==void 0?_item$category_id:null,example_phrases:(_item$example_phrases=item.example_phrases)!==null&&_item$example_phrases!==void 0?_item$example_phrases:null,meanings:(_item$meanings=item.meanings)!==null&&_item$meanings!==void 0?_item$meanings:null,grammar_roles:(_item$grammar_roles=item.grammar_roles)!==null&&_item$grammar_roles!==void 0?_item$grammar_roles:null,collocations:(_item$collocations=item.collocations)!==null&&_item$collocations!==void 0?_item$collocations:null,synonyms:(_item$synonyms=item.synonyms)!==null&&_item$synonyms!==void 0?_item$synonyms:null,antonyms:(_item$antonyms=item.antonyms)!==null&&_item$antonyms!==void 0?_item$antonyms:null,related_words:null,word_forms:null,videos:null,use_count:(_item$use_count=item.use_count)!==null&&_item$use_count!==void 0?_item$use_count:0,notes:(_item$notes=item.notes)!==null&&_item$notes!==void 0?_item$notes:null,created_at:(_item$created_at=item.created_at)!==null&&_item$created_at!==void 0?_item$created_at:new Date().toISOString(),user_created:0,children:null};setCard(minimalCard);}finally{setIsLoading(false);}};loadCard();},[item]);if(isLoading||!card){return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg p-6 max-w-md w-full mx-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-600\",children:\"Loading card...\"})})})});}return/*#__PURE__*/_jsx(UpdateCardAI,{card:card,onClose:onClose,onSuccess:onSuccess});};","map":{"version":3,"names":["React","useState","useRef","useEffect","AddItemInput","CardDetail","UpdateCardAI","AICardForm","PracticeCard","FolderView","MoveToModal","DropdownMenu","createEditAction","createDeleteAction","createAICardAction","createPracticeCardAction","handleConditionalDelete","apiClient","ChevronRight","ChevronDown","Folder","FileText","Plus","GripVertical","Hash","Sparkles","Move","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","TreeNode","_ref","item","onToggle","onRename","onDelete","onAddChild","onMove","level","categoryId","categories","isEditing","setIsEditing","editName","setEditName","name","showAddInput","setShowAddInput","addType","setAddType","showDetail","setShowDetail","showUpdateAI","setShowUpdateAI","showAICardForm","setShowAICardForm","showPracticeCard","setShowPracticeCard","newCardId","setNewCardId","showFolderView","setShowFolderView","showMoveToModal","setShowMoveToModal","isDragging","setIsDragging","dragOver","setDragOver","isDragTarget","setIsDragTarget","nodeRef","longPressTimer","draggedItemRef","isMobile","window","innerWidth","handleRename","trim","id","handleCancelEdit","handleKeyDown","e","key","handleAddChild","handleAddFolder","handleAddCard","handleCardClick","handleFolderClick","is_folder","handleDetailClose","handleDetailSave","location","reload","handleAICardSuccess","cardId","handleNewCardDetailClose","handleNewCardDetailSave","isTargetSubfolder","targetItem","parent_id","undefined","handleDragStart","preventDefault","dataTransfer","effectAllowed","dragData","type","category_id","setData","JSON","stringify","current","currentTarget","HTMLElement","style","opacity","handleDragEnd","handleDragOver","stopPropagation","canMoveToTarget","dropEffect","handleDragLeave","handleDrop","parse","getData","draggedItem","children","alert","err","_err$response","_err$response$data","console","error","response","data","detail","isDescendant","parent","childId","some","child","handleTouchStart","setTimeout","touch","touches","dragEvent","DragEvent","bubbles","cancelable","handleTouchEnd","clearTimeout","handleTouchMove","getDropdownItems","items","label","icon","className","onClick","push","handleAIUpdateSuccess","updatedCard","indentPx","itemCount","length","hasChildren","isTopLevelFolder","isSubfolder","isCard","ref","draggable","onDragStart","onDragEnd","onDragOver","onDragLeave","onDrop","onTouchStart","onTouchEnd","onTouchMove","concat","marginLeft","onMouseDown","isExpanded","value","onChange","target","onBlur","onKeyDown","autoFocus","title","minWidth","minHeight","_item$children","_item$children2","folderCount","filter","cardCount","parentId","onSubmit","onCancel","placeholder","map","onClose","onSave","UpdateCardAIWrapper","onSuccess","parentName","folder","_ref2","card","setCard","isLoading","setIsLoading","loadCard","cardData","getCard","_item$parent_id","_item$category_id","_item$example_phrases","_item$meanings","_item$grammar_roles","_item$collocations","_item$synonyms","_item$antonyms","_item$use_count","_item$notes","_item$created_at","minimalCard","example_phrases","meanings","grammar_roles","collocations","synonyms","antonyms","related_words","word_forms","videos","use_count","notes","created_at","Date","toISOString","user_created"],"sources":["/Users/tassiobs/Documents/vocatree-fe/src/components/TreeNode.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { TreeNodeProps, TreeItem, CategoryItem } from '../types';\nimport { AddItemInput } from './AddItemInput';\nimport { CardDetail } from './CardDetail';\nimport { UpdateCardAI } from './UpdateCardAI';\nimport { AICardForm } from './AICardForm';\nimport { PracticeCard } from './PracticeCard';\nimport { FolderView } from './FolderView';\nimport { MoveToModal } from './MoveToModal';\nimport { DropdownMenu, DropdownMenuItem, createEditAction, createDeleteAction, createAICardAction, createPracticeCardAction } from './DropdownMenu';\nimport { handleConditionalDelete } from '../utils/deleteUtils';\nimport { apiClient } from '../services/api';\nimport { Card } from '../types/api';\nimport { \n  ChevronRight, \n  ChevronDown, \n  Folder, \n  FileText, \n  Plus,\n  GripVertical,\n  Hash,\n  Sparkles,\n  Move\n} from 'lucide-react';\n\nexport const TreeNode: React.FC<TreeNodeProps> = ({\n  item,\n  onToggle,\n  onRename,\n  onDelete,\n  onAddChild,\n  onMove,\n  level,\n  categoryId,\n  categories = [],\n}) => {\n  const [isEditing, setIsEditing] = useState(false);\n  const [editName, setEditName] = useState(item.name);\n  const [showAddInput, setShowAddInput] = useState(false);\n  const [addType, setAddType] = useState<'folder' | 'card'>('card');\n  const [showDetail, setShowDetail] = useState(false);\n  const [showUpdateAI, setShowUpdateAI] = useState(false);\n  const [showAICardForm, setShowAICardForm] = useState(false);\n  const [showPracticeCard, setShowPracticeCard] = useState(false);\n  const [newCardId, setNewCardId] = useState<number | null>(null);\n  const [showFolderView, setShowFolderView] = useState(false);\n  const [showMoveToModal, setShowMoveToModal] = useState(false);\n  \n  // Drag and drop state\n  const [isDragging, setIsDragging] = useState(false);\n  const [dragOver, setDragOver] = useState(false);\n  const [isDragTarget, setIsDragTarget] = useState(false);\n  const nodeRef = useRef<HTMLDivElement>(null);\n  const longPressTimer = useRef<NodeJS.Timeout | null>(null);\n  const draggedItemRef = useRef<TreeItem | null>(null);\n  const isMobile = typeof window !== 'undefined' && window.innerWidth < 768;\n\n  const handleRename = () => {\n    if (editName.trim() && editName.trim() !== item.name) {\n      onRename(item.id, editName.trim());\n    }\n    setIsEditing(false);\n  };\n\n  const handleCancelEdit = () => {\n    setEditName(item.name);\n    setIsEditing(false);\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      handleRename();\n    } else if (e.key === 'Escape') {\n      handleCancelEdit();\n    }\n  };\n\n  const handleAddChild = (name: string) => {\n    onAddChild(item.id, addType, name);\n    setShowAddInput(false);\n  };\n\n  const handleAddFolder = () => {\n    setAddType('folder');\n    setShowAddInput(true);\n  };\n\n  const handleAddCard = () => {\n    setAddType('card');\n    setShowAddInput(true);\n  };\n\n  const handleCardClick = () => {\n    if (!isEditing) {\n      setShowDetail(true);\n    }\n  };\n\n  const handleFolderClick = () => {\n    if (!isEditing && item.is_folder) {\n      setShowFolderView(true);\n    }\n  };\n\n  const handleDetailClose = () => {\n    setShowDetail(false);\n  };\n\n  const handleDetailSave = () => {\n    // Refresh the parent tree to show updated data\n    window.location.reload();\n  };\n\n  const handleAICardSuccess = (cardId: number) => {\n    setShowAICardForm(false);\n    // Open the card detail view immediately to show the created card data\n    setNewCardId(cardId);\n  };\n\n  const handleNewCardDetailClose = () => {\n    setNewCardId(null);\n    // Refresh the tree after closing to show the new card in the tree\n    window.location.reload();\n  };\n\n  const handleNewCardDetailSave = () => {\n    // Refresh the parent tree to show updated data\n    window.location.reload();\n  };\n\n  // Check if target folder is a subfolder (has a parent_id)\n  const isTargetSubfolder = (targetItem: TreeItem): boolean => {\n    return targetItem.parent_id !== null && targetItem.parent_id !== undefined;\n  };\n\n  // Drag handlers\n  const handleDragStart = (e: React.DragEvent) => {\n    if (isEditing) {\n      e.preventDefault();\n      return;\n    }\n    setIsDragging(true);\n    e.dataTransfer.effectAllowed = 'move';\n    const dragData = {\n      id: item.id,\n      type: item.type,\n      parent_id: item.parent_id,\n      category_id: item.category_id,\n    };\n    e.dataTransfer.setData('application/json', JSON.stringify(dragData));\n    draggedItemRef.current = item;\n    // Add visual feedback\n    if (e.currentTarget instanceof HTMLElement) {\n      e.currentTarget.style.opacity = '0.5';\n    }\n  };\n\n  const handleDragEnd = (e: React.DragEvent) => {\n    setIsDragging(false);\n    setDragOver(false);\n    draggedItemRef.current = null;\n    if (e.currentTarget instanceof HTMLElement) {\n      e.currentTarget.style.opacity = '1';\n    }\n  };\n\n  const handleDragOver = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    \n    // Check if this is a valid drop target\n    if (item.is_folder && draggedItemRef.current) {\n      // Validate if dragged item can be moved to this folder\n      if (canMoveToTarget(draggedItemRef.current, item)) {\n        e.dataTransfer.dropEffect = 'move';\n        setDragOver(true);\n        setIsDragTarget(true);\n      } else {\n        e.dataTransfer.dropEffect = 'none';\n        setDragOver(false);\n        setIsDragTarget(false);\n      }\n    } else if (!item.is_folder) {\n      e.dataTransfer.dropEffect = 'none';\n      setDragOver(false);\n      setIsDragTarget(false);\n    }\n  };\n\n  const handleDragLeave = (e: React.DragEvent) => {\n    e.preventDefault();\n    setDragOver(false);\n    setIsDragTarget(false);\n  };\n\n  const handleDrop = async (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragOver(false);\n    setIsDragTarget(false);\n    \n    try {\n      const dragData = JSON.parse(e.dataTransfer.getData('application/json'));\n      const draggedItem: TreeItem = {\n        id: dragData.id,\n        type: dragData.type,\n        parent_id: dragData.parent_id,\n        is_folder: dragData.type === 'folder',\n        children: [],\n      };\n      \n      if (draggedItem.id === item.id || !item.is_folder) return;\n      \n      // Validate move\n      if (!canMoveToTarget(draggedItem, item)) {\n        alert('Cannot move here. Subfolders cannot contain other folders.');\n        return;\n      }\n\n      // Move to this folder\n      await onMove(draggedItem.id, { parent_id: item.id });\n    } catch (err: any) {\n      console.error('Error handling drop:', err);\n      alert(err.response?.data?.detail || 'Failed to move item');\n    }\n  };\n\n  // Check if dragged item can be moved to target\n  const canMoveToTarget = (draggedItem: TreeItem, targetItem: TreeItem): boolean => {\n    // Can't move to itself\n    if (draggedItem.id === targetItem.id) return false;\n    \n    // Can't move to its own children (prevent circular reference)\n    const isDescendant = (parent: TreeItem, childId: number): boolean => {\n      if (parent.id === childId) return true;\n      return parent.children.some((child) => isDescendant(child, childId));\n    };\n    if (isDescendant(draggedItem, targetItem.id)) return false;\n    \n    // Folders can't be moved into subfolders\n    if (draggedItem.is_folder && targetItem.is_folder && isTargetSubfolder(targetItem)) {\n      return false;\n    }\n    \n    return true;\n  };\n\n  // Mobile long-press handler\n  const handleTouchStart = (e: React.TouchEvent) => {\n    if (isEditing || !isMobile) return;\n    \n    longPressTimer.current = setTimeout(() => {\n      setIsDragging(true);\n      // Trigger drag on mobile\n      const touch = e.touches[0];\n      const dragEvent = new DragEvent('dragstart', {\n        bubbles: true,\n        cancelable: true,\n      });\n      // Note: Touch drag is limited, so we'll use Move To modal instead\n    }, 500); // 500ms long press\n  };\n\n  const handleTouchEnd = () => {\n    if (longPressTimer.current) {\n      clearTimeout(longPressTimer.current);\n      longPressTimer.current = null;\n    }\n    setIsDragging(false);\n  };\n\n  const handleTouchMove = () => {\n    if (longPressTimer.current) {\n      clearTimeout(longPressTimer.current);\n      longPressTimer.current = null;\n    }\n  };\n\n  useEffect(() => {\n    return () => {\n      if (longPressTimer.current) {\n        clearTimeout(longPressTimer.current);\n      }\n    };\n  }, []);\n\n  // Create dropdown menu items\n  const getDropdownItems = (): DropdownMenuItem[] => {\n    const items: DropdownMenuItem[] = [\n      createEditAction(() => setIsEditing(true)),\n      {\n        id: 'move',\n        label: 'Move To...',\n        icon: <Move className=\"h-4 w-4\" />,\n        onClick: () => setShowMoveToModal(true),\n      },\n      createDeleteAction(() => handleConditionalDelete(item, () => onDelete(item.id))),\n    ];\n\n    // Add \"Update Card using AI\" and \"Practice card\" actions only for cards (not folders)\n    if (!item.is_folder) {\n      items.push({\n        id: 'update-ai',\n        label: 'Update Card using AI',\n        icon: <Sparkles className=\"h-4 w-4\" />,\n        onClick: () => setShowUpdateAI(true),\n      });\n      items.push(createPracticeCardAction(() => setShowPracticeCard(true)));\n    }\n\n    // Add \"Add a card using AI\" action for folders\n    if (item.is_folder) {\n      items.push(createAICardAction(() => setShowAICardForm(true)));\n    }\n\n    return items;\n  };\n\n  // Handle AI update success\n  const handleAIUpdateSuccess = async (updatedCard: Card) => {\n    setShowUpdateAI(false);\n    // Open the card detail view with updated data\n    // The CardDetail component will automatically reload the card data\n    setShowDetail(true);\n  };\n\n  // Calculate indentation based on level\n  const indentPx = level * 24; // Increased from 20px for better visual separation\n  \n  // Get item count for folders\n  const itemCount = item.children ? item.children.length : 0;\n  const hasChildren = item.children && item.children.length > 0;\n  \n  // Different styling based on level and type\n  const isTopLevelFolder = level === 0 && item.is_folder;\n  const isSubfolder = level === 1 && item.is_folder;\n  const isCard = !item.is_folder;\n\n  return (\n    <div className=\"relative\">\n      {/* Main item container */}\n      <div \n        ref={nodeRef}\n        draggable={!isEditing && !isMobile}\n        onDragStart={handleDragStart}\n        onDragEnd={handleDragEnd}\n        onDragOver={handleDragOver}\n        onDragLeave={handleDragLeave}\n        onDrop={handleDrop}\n        onTouchStart={isMobile ? handleTouchStart : undefined}\n        onTouchEnd={isMobile ? handleTouchEnd : undefined}\n        onTouchMove={isMobile ? handleTouchMove : undefined}\n        className={`group transition-all duration-200 ${\n          isTopLevelFolder \n            ? 'py-3 px-4 bg-blue-50 border-l-4 border-blue-400 rounded-lg mb-2 hover:bg-blue-100' \n            : isSubfolder\n            ? 'py-2 px-3 ml-6 bg-gray-50 border-l-2 border-gray-300 rounded-md mb-1 hover:bg-gray-100'\n            : isCard\n            ? 'py-1.5 px-3 ml-8 hover:bg-gray-50 rounded-md border-l border-gray-200'\n            : 'py-2 px-3 hover:bg-gray-50 rounded-md'\n        } ${\n          isDragging ? 'opacity-50 cursor-grabbing' : 'cursor-move'\n        } ${\n          dragOver && item.is_folder ? 'bg-green-100 border-green-400 border-2 ring-2 ring-green-300' : ''\n        }`}\n        style={{ marginLeft: `${indentPx}px` }}\n      >\n        {/* Desktop layout - single row */}\n        <div className=\"hidden lg:flex items-center flex-1 min-w-0\">\n          {/* Drag handle - always visible for draggable items */}\n          <div \n            className={`mr-2 transition-opacity ${\n              isMobile ? 'opacity-50' : 'opacity-0 group-hover:opacity-100'\n            } cursor-grab active:cursor-grabbing`}\n            onMouseDown={(e) => e.stopPropagation()}\n            onTouchStart={(e) => {\n              e.stopPropagation();\n              if (isMobile) {\n                handleTouchStart(e as any);\n              }\n            }}\n          >\n            <GripVertical className=\"h-3 w-3 text-gray-400\" />\n          </div>\n\n          {/* Expand/collapse button - only for items with children */}\n          {hasChildren && (\n            <button\n              onClick={() => onToggle(item.id)}\n              className={`mr-2 p-1 hover:bg-gray-200 rounded transition-colors ${\n                isTopLevelFolder ? 'hover:bg-blue-200' : ''\n              }`}\n            >\n              {item.isExpanded ? (\n                <ChevronDown className=\"h-4 w-4 text-gray-600\" />\n              ) : (\n                <ChevronRight className=\"h-4 w-4 text-gray-600\" />\n              )}\n            </button>\n          )}\n\n          {/* Spacer for items without expand button */}\n          {!hasChildren && <div className=\"w-6 mr-2\" />}\n\n          {/* Icon with different styling based on type and level */}\n          <div className=\"mr-3 flex-shrink-0\">\n            {item.is_folder ? (\n              <Folder className={`${isTopLevelFolder ? 'h-5 w-5 text-blue-600' : 'h-4 w-4 text-blue-500'}`} />\n            ) : (\n              <FileText className=\"h-3.5 w-3.5 text-gray-500\" />\n            )}\n          </div>\n\n          {/* Name with appropriate styling */}\n          <div className=\"flex-1 min-w-0\">\n            {isEditing ? (\n              <input\n                type=\"text\"\n                value={editName}\n                onChange={(e) => setEditName(e.target.value)}\n                onBlur={handleRename}\n                onKeyDown={handleKeyDown}\n                className={`w-full border-0 outline-none bg-transparent ${\n                  isTopLevelFolder ? 'text-lg font-semibold' : 'text-sm'\n                }`}\n                autoFocus\n              />\n            ) : (\n              <button\n                onClick={isCard ? handleCardClick : handleFolderClick}\n                className={`truncate text-left w-full transition-colors ${\n                  isTopLevelFolder \n                    ? 'text-lg font-semibold text-gray-900 hover:text-blue-700' \n                    : isSubfolder\n                    ? 'text-sm font-medium text-gray-800 hover:text-blue-600'\n                    : 'text-sm text-gray-600 hover:text-gray-900'\n                }`}\n              >\n                {item.name}\n              </button>\n            )}\n          </div>\n\n          {/* Item count for folders - Desktop */}\n          {item.is_folder && itemCount > 0 && (\n            <div className=\"mr-2 flex items-center\">\n              <Hash className=\"h-3 w-3 text-gray-400 mr-1\" />\n              <span className=\"text-xs text-gray-500\">{itemCount}</span>\n            </div>\n          )}\n\n          {/* Add buttons - only for folders */}\n          {item.is_folder && (\n            <div className=\"flex items-center space-x-1\">\n              {item.parent_id === null && (\n                <button\n                  onClick={handleAddFolder}\n                  className=\"p-1 hover:bg-blue-100 rounded bg-blue-50\"\n                  title=\"Add subfolder\"\n                >\n                  <Folder className=\"h-3 w-3 text-blue-600\" />\n                </button>\n              )}\n              <button\n                onClick={handleAddCard}\n                className=\"p-1 hover:bg-gray-200 rounded bg-gray-100\"\n                title=\"Add card\"\n              >\n                <Plus className=\"h-3 w-3 text-gray-700\" />\n              </button>\n            </div>\n          )}\n\n          {/* Actions dropdown menu */}\n          <div className=\"ml-2\">\n            <DropdownMenu\n              items={getDropdownItems()}\n              className=\"opacity-0 group-hover:opacity-100 transition-opacity\"\n            />\n          </div>\n        </div>\n\n        {/* Mobile layout - responsive stacked design */}\n        <div className=\"lg:hidden\">\n          {/* Top row: Icon, name, and expand button */}\n          <div className=\"flex items-center justify-between mb-2\">\n            <div className=\"flex items-center flex-1 min-w-0\">\n              {/* Drag handle - always visible for draggable items */}\n              <div \n                className={`mr-2 transition-opacity ${\n                  isMobile ? 'opacity-50' : 'opacity-0 group-hover:opacity-100'\n                } cursor-grab active:cursor-grabbing`}\n                onMouseDown={(e) => e.stopPropagation()}\n                onTouchStart={(e) => {\n                  e.stopPropagation();\n                  if (isMobile) {\n                    handleTouchStart(e as any);\n                  }\n                }}\n              >\n                <GripVertical className=\"h-3 w-3 text-gray-400\" />\n              </div>\n\n              {/* Expand/collapse button - only for items with children */}\n              {hasChildren && (\n                <button\n                  onClick={() => onToggle(item.id)}\n                  className={`mr-2 p-1.5 hover:bg-gray-200 rounded transition-colors ${\n                    isTopLevelFolder ? 'hover:bg-blue-200' : ''\n                  }`}\n                  style={{ minWidth: '44px', minHeight: '44px' }}\n                >\n                  {item.isExpanded ? (\n                    <ChevronDown className=\"h-4 w-4 text-gray-600\" />\n                  ) : (\n                    <ChevronRight className=\"h-4 w-4 text-gray-600\" />\n                  )}\n                </button>\n              )}\n\n              {/* Spacer for items without expand button */}\n              {!hasChildren && <div className=\"w-6 mr-2\" />}\n\n              {/* Icon with different styling based on type and level */}\n              <div className=\"mr-3 flex-shrink-0\">\n                {item.is_folder ? (\n                  <Folder className={`${isTopLevelFolder ? 'h-5 w-5 text-blue-600' : 'h-4 w-4 text-blue-500'}`} />\n                ) : (\n                  <FileText className=\"h-3.5 w-3.5 text-gray-500\" />\n                )}\n              </div>\n\n              {/* Name with appropriate styling */}\n              <div className=\"flex-1 min-w-0\">\n                {isEditing ? (\n                  <input\n                    type=\"text\"\n                    value={editName}\n                    onChange={(e) => setEditName(e.target.value)}\n                    onBlur={handleRename}\n                    onKeyDown={handleKeyDown}\n                    className={`w-full border-0 outline-none bg-transparent ${\n                      isTopLevelFolder ? 'text-lg font-semibold' : 'text-sm'\n                    }`}\n                    autoFocus\n                  />\n                ) : (\n                  <button\n                    onClick={isCard ? handleCardClick : handleFolderClick}\n                    className={`truncate text-left w-full transition-colors ${\n                      isTopLevelFolder \n                        ? 'text-lg font-semibold text-gray-900 hover:text-blue-700' \n                        : isSubfolder\n                        ? 'text-sm font-medium text-gray-800 hover:text-blue-600'\n                        : 'text-sm text-gray-600 hover:text-gray-900'\n                    }`}\n                  >\n                    {item.name}\n                  </button>\n                )}\n              </div>\n            </div>\n\n            {/* Actions dropdown menu - always visible on mobile */}\n            <div className=\"ml-2 flex-shrink-0\">\n              <DropdownMenu\n                items={getDropdownItems()}\n                className=\"opacity-100\"\n              />\n            </div>\n          </div>\n\n          {/* Bottom row: Item count and add buttons */}\n          <div className=\"flex items-center justify-between\">\n            {/* Stats section - Mobile */}\n            {item.is_folder && itemCount > 0 && (\n              <div className=\"stats flex items-center space-x-4\">\n                {/* Count individual items by type */}\n                {(() => {\n                  const folderCount = item.children?.filter(child => child.is_folder).length || 0;\n                  const cardCount = item.children?.filter(child => !child.is_folder).length || 0;\n                  \n                  return (\n                    <>\n                      {folderCount > 0 && (\n                        <div className=\"flex items-center bg-blue-50 px-2 py-1 rounded-md\">\n                          <Folder className=\"h-3 w-3 text-blue-600 mr-1\" />\n                          <span className=\"text-xs font-medium text-blue-700\">{folderCount}</span>\n                        </div>\n                      )}\n                      {cardCount > 0 && (\n                        <div className=\"flex items-center bg-gray-50 px-2 py-1 rounded-md\">\n                          <FileText className=\"h-3 w-3 text-gray-600 mr-1\" />\n                          <span className=\"text-xs font-medium text-gray-700\">{cardCount}</span>\n                        </div>\n                      )}\n                    </>\n                  );\n                })()}\n              </div>\n            )}\n\n            {/* Add buttons - only for folders */}\n            {item.is_folder && (\n              <div className=\"flex items-center space-x-2\">\n                {item.parent_id === null && (\n                  <button\n                    onClick={handleAddFolder}\n                    className=\"px-3 py-2 text-xs font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-md transition-colors\"\n                    title=\"Add subfolder\"\n                    style={{ minHeight: '44px' }}\n                  >\n                    <Folder className=\"h-3 w-3 inline mr-1\" />\n                    Add Folder\n                  </button>\n                )}\n                <button\n                  onClick={handleAddCard}\n                  className=\"px-3 py-2 text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors\"\n                  title=\"Add card\"\n                  style={{ minHeight: '44px' }}\n                >\n                  <Plus className=\"h-3 w-3 inline mr-1\" />\n                  Add Card\n                </button>\n              </div>\n            )}\n\n            {/* Spacer if no add buttons */}\n            {!item.is_folder && <div />}\n          </div>\n        </div>\n      </div>\n\n      {/* Add item input */}\n      {showAddInput && (\n        <div \n          className=\"mt-2\"\n          style={{ marginLeft: `${indentPx + 24}px` }}\n        >\n          <AddItemInput\n            parentId={item.id}\n            type={addType}\n            onSubmit={handleAddChild}\n            onCancel={() => setShowAddInput(false)}\n            placeholder={`Add ${addType}...`}\n          />\n        </div>\n      )}\n\n      {/* Children */}\n      {item.isExpanded && item.children && item.children.length > 0 && (\n        <div className=\"mt-1\">\n          {item.children.map((child) => (\n            <TreeNode\n              key={child.id}\n              item={child}\n              onToggle={onToggle}\n              onRename={onRename}\n              onDelete={onDelete}\n              onAddChild={onAddChild}\n              onMove={onMove}\n              level={level + 1}\n            />\n          ))}\n        </div>\n      )}\n\n      {/* Card Detail Modal */}\n      {showDetail && (\n        <CardDetail\n          cardId={item.id}\n          onClose={handleDetailClose}\n          onSave={handleDetailSave}\n        />\n      )}\n\n      {/* Update Card AI Modal */}\n      {showUpdateAI && (\n        <UpdateCardAIWrapper\n          item={item}\n          onClose={() => setShowUpdateAI(false)}\n          onSuccess={handleAIUpdateSuccess}\n        />\n      )}\n\n      {/* AI Card Form Modal */}\n      {showAICardForm && item.is_folder && (\n        <AICardForm\n          parentId={item.id}\n          parentName={item.name}\n          onClose={() => setShowAICardForm(false)}\n          onSuccess={handleAICardSuccess}\n        />\n      )}\n\n      {/* Card Detail Modal for newly created AI card */}\n      {newCardId !== null && (\n        <CardDetail\n          cardId={newCardId}\n          onClose={handleNewCardDetailClose}\n          onSave={handleNewCardDetailSave}\n        />\n      )}\n\n      {/* Practice Card Modal */}\n      {showPracticeCard && !item.is_folder && (\n        <PracticeCard\n          cardId={item.id}\n          onClose={() => setShowPracticeCard(false)}\n        />\n      )}\n\n      {/* Folder View Modal */}\n      {showFolderView && item.is_folder && (\n        <FolderView\n          folder={item}\n          onClose={() => setShowFolderView(false)}\n          onRename={onRename}\n          onDelete={onDelete}\n          onMove={onMove}\n          categories={categories}\n        />\n      )}\n\n      {/* Move To Modal */}\n      {showMoveToModal && categories.length > 0 && (\n        <MoveToModal\n          item={item}\n          categories={categories}\n          onClose={() => setShowMoveToModal(false)}\n          onMove={onMove}\n        />\n      )}\n    </div>\n  );\n};\n\n// Wrapper component to handle async card conversion\nconst UpdateCardAIWrapper: React.FC<{\n  item: TreeNodeProps['item'];\n  onClose: () => void;\n  onSuccess: (card: Card) => void;\n}> = ({ item, onClose, onSuccess }) => {\n  const [card, setCard] = useState<Card | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  React.useEffect(() => {\n    const loadCard = async () => {\n      try {\n        const cardData = await apiClient.getCard(item.id);\n        setCard(cardData);\n      } catch (error) {\n        // If fetch fails, create a minimal card object from the item\n        const minimalCard: Card = {\n          id: item.id,\n          name: item.name,\n          parent_id: item.parent_id ?? null,\n          is_folder: item.is_folder,\n          category_id: item.category_id ?? null,\n          example_phrases: item.example_phrases ?? null,\n          meanings: item.meanings ?? null,\n          grammar_roles: item.grammar_roles ?? null,\n          collocations: item.collocations ?? null,\n          synonyms: item.synonyms ?? null,\n          antonyms: item.antonyms ?? null,\n          related_words: null,\n          word_forms: null,\n          videos: null,\n          use_count: item.use_count ?? 0,\n          notes: item.notes ?? null,\n          created_at: item.created_at ?? new Date().toISOString(),\n          user_created: 0,\n          children: null,\n        };\n        setCard(minimalCard);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    loadCard();\n  }, [item]);\n\n  if (isLoading || !card) {\n    return (\n      <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n        <div className=\"bg-white rounded-lg p-6 max-w-md w-full mx-4\">\n          <div className=\"flex items-center justify-center\">\n            <div className=\"text-gray-600\">Loading card...</div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return <UpdateCardAI card={card} onClose={onClose} onSuccess={onSuccess} />;\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}