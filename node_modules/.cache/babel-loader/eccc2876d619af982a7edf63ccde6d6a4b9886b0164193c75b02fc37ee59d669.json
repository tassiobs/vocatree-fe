{"ast":null,"code":"import _objectSpread from\"/Users/tassiobs/Documents/vocatree-fe/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useCallback,useRef}from'react';import{CategoryNode}from'./CategoryNode';import{AddItemInput}from'./AddItemInput';import{AITreeGenerator}from'./AITreeGenerator';import{apiClient}from'../services/api';import{buildTree,updateTreeItem,removeTreeItem,findTreeItem,getExpandedIds,moveItemAcrossCategories}from'../utils/treeUtils';import{Loader2,Sparkles,Tag}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const VocabTree=()=>{const[categories,setCategories]=useState([]);const[isLoading,setIsLoading]=useState(true);const[error,setError]=useState(null);const[showAIGenerator,setShowAIGenerator]=useState(false);const[showAddCategory,setShowAddCategory]=useState(false);const categoriesRef=useRef([]);// Keep ref in sync with state\nuseEffect(()=>{categoriesRef.current=categories;},[categories]);// Load initial data\nuseEffect(()=>{loadCategories();},[]);const loadCategories=async()=>{try{setIsLoading(true);setError(null);// First try to get categories\nlet categoriesData;try{categoriesData=await apiClient.getCategories();console.log('Categories response:',categoriesData);}catch(categoryErr){console.error('Categories endpoint error:',categoryErr);// If categories endpoint doesn't exist, fall back to loading all cards without categories\nconst allCards=await apiClient.getCardsHierarchy();const treeData=buildTree(allCards);// Create a default \"All Items\" category\nsetCategories([{id:0,name:'All Items',isExpanded:true,children:treeData}]);setIsLoading(false);return;}const categoriesWithChildren=await Promise.all(categoriesData.map(async category=>{try{const cards=await apiClient.getCardsHierarchy(category.id);const treeData=buildTree(cards);return{id:category.id,name:category.name,isExpanded:false,children:treeData};}catch(err){console.error(\"Error loading cards for category \".concat(category.id,\":\"),err);return{id:category.id,name:category.name,isExpanded:false,children:[]};}}));setCategories(categoriesWithChildren);}catch(err){var _err$response,_err$response$data;console.error('Error loading categories:',err);setError(\"Failed to load categories: \".concat(err.message||((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.detail)||'Unknown error'));}finally{setIsLoading(false);}};const handleToggle=useCallback(id=>{setCategories(prevCategories=>prevCategories.map(category=>{var _findTreeItem;if(category.id===id){return _objectSpread(_objectSpread({},category),{},{isExpanded:!category.isExpanded});}return _objectSpread(_objectSpread({},category),{},{children:updateTreeItem(category.children,id,{isExpanded:!((_findTreeItem=findTreeItem(category.children,id))!==null&&_findTreeItem!==void 0&&_findTreeItem.isExpanded)})});}));},[]);const handleRename=useCallback(async(id,newName)=>{try{// Check if this is a category rename\n// Note: CategoryNode already makes the API call for categories, so we only update UI\n// For non-categories (cards/folders), we need to make the API call\nconst isCategory=categories.some(cat=>cat.id===id);if(!isCategory){// For non-categories, make the API call\nawait apiClient.updateCard(id,{name:newName});}// Update UI state for both categories and non-categories\nsetCategories(prevCategories=>prevCategories.map(category=>{// Check if this is a category rename\nif(category.id===id){return _objectSpread(_objectSpread({},category),{},{name:newName});}// Otherwise, update children\nreturn _objectSpread(_objectSpread({},category),{},{children:updateTreeItem(category.children,id,{name:newName})});}));}catch(err){var _err$response2,_err$response2$data;setError(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.detail)||'Failed to rename item');console.error('Error renaming item:',err);}},[categories]);const handleDelete=useCallback(id=>{// This function is called after the API delete has already been handled by handleConditionalDelete\n// We just need to update the UI state\nconsole.log(\"VocabTree handleDelete called for item \".concat(id,\" - updating UI only\"));setCategories(prevCategories=>prevCategories.map(category=>_objectSpread(_objectSpread({},category),{},{children:removeTreeItem(category.children,id)})));},[]);const handleCategoryRefresh=useCallback(async(categoryId,expandFolderId)=>{try{setCategories(prevCategories=>{// Find the category to get current expanded state\nconst currentCategory=prevCategories.find(cat=>cat.id===categoryId);// Get currently expanded IDs\nconst expandedIds=currentCategory?getExpandedIds(currentCategory.children):new Set();// If we have a folder to expand, add it to the set\nif(expandFolderId){expandedIds.add(expandFolderId);}return prevCategories;// Return unchanged for now, will update after fetch\n});const updatedCards=await apiClient.getCardsHierarchy(categoryId);setCategories(prevCategories=>{const currentCategory=prevCategories.find(cat=>cat.id===categoryId);const expandedIds=currentCategory?getExpandedIds(currentCategory.children):new Set();if(expandFolderId){expandedIds.add(expandFolderId);}const updatedTreeData=buildTree(updatedCards,expandedIds);return prevCategories.map(category=>{if(category.id===categoryId){return _objectSpread(_objectSpread({},category),{},{children:updatedTreeData,isExpanded:true// Auto-expand when adding children\n});}return category;});});}catch(err){console.error('Error refreshing category:',err);}},[]);const handleAddCategory=async name=>{try{const newCategory=await apiClient.createCategory(name);const newCategoryItem={id:newCategory.id,name:newCategory.name,isExpanded:false,children:[]};setCategories(prevCategories=>[...prevCategories,newCategoryItem]);setShowAddCategory(false);}catch(err){var _err$response3,_err$response3$data;console.error('Error adding category:',err);setError(\"Failed to add category: \".concat(err.message||((_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.detail)||'Unknown error'));}};const handleMove=useCallback(async(itemId,data)=>{// Store original state for rollback on error (deep clone using JSON)\nconst originalCategories=JSON.parse(JSON.stringify(categoriesRef.current));// Optimistically update UI\nsetCategories(prevCategories=>{var _data$parent_id,_data$category_id;const updated=moveItemAcrossCategories(prevCategories,itemId,(_data$parent_id=data.parent_id)!==null&&_data$parent_id!==void 0?_data$parent_id:null,(_data$category_id=data.category_id)!==null&&_data$category_id!==void 0?_data$category_id:null);// Update ref with new state\ncategoriesRef.current=updated;return updated;});try{await apiClient.moveCard(itemId,data);// Success - UI already updated optimistically\n}catch(err){var _err$response4,_err$response4$data;// Rollback on error\nsetCategories(originalCategories);categoriesRef.current=originalCategories;setError(((_err$response4=err.response)===null||_err$response4===void 0?void 0:(_err$response4$data=_err$response4.data)===null||_err$response4$data===void 0?void 0:_err$response4$data.detail)||'Failed to move item');console.error('Error moving item:',err);throw err;}},[]);const handleAIGeneratorSuccess=()=>{loadCategories();// Reload categories after AI generation\n};// Note: flattenTree utility is available for future drag and drop enhancements\nif(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-64\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Loader2,{className:\"h-6 w-6 animate-spin text-primary-600\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Loading vocabulary tree...\"})]})});}if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-md bg-red-50 p-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-red-700\",children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:loadCategories,className:\"mt-2 text-sm text-red-600 hover:text-red-800 underline\",children:\"Try again\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:\"Vocabulary Tree\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowAIGenerator(true),className:\"flex items-center space-x-1 px-3 py-2 text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 rounded-md transition-colors\",children:[/*#__PURE__*/_jsx(Sparkles,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Generate with AI\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowAddCategory(true),className:\"flex items-center space-x-1 px-3 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-md transition-colors\",children:[/*#__PURE__*/_jsx(Tag,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Add Category\"})]})]})]}),showAddCategory&&/*#__PURE__*/_jsx(\"div\",{className:\"border border-gray-200 rounded-lg p-4 bg-gray-50\",children:/*#__PURE__*/_jsx(AddItemInput,{parentId:null,type:\"folder\",onSubmit:handleAddCategory,onCancel:()=>setShowAddCategory(false),placeholder:\"Add category...\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:categories.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center py-12 text-gray-500 border border-gray-200 rounded-lg bg-white\",children:[/*#__PURE__*/_jsx(Tag,{className:\"h-12 w-12 mb-4 opacity-50\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-medium mb-2\",children:\"No categories yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm mb-4\",children:\"Start by adding your first category\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowAddCategory(true),className:\"px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-md\",children:\"Add Category\"})]}):categories.map(category=>/*#__PURE__*/_jsx(CategoryNode,{category:category,onToggle:handleToggle,onRename:handleRename,onDelete:handleDelete,onAddChild:()=>{}// Not used anymore\n,onMove:handleMove,onCategoryUpdate:loadCategories,onCategoryRefresh:handleCategoryRefresh,categories:categories},category.id))}),showAIGenerator&&/*#__PURE__*/_jsx(AITreeGenerator,{onClose:()=>setShowAIGenerator(false),onSuccess:handleAIGeneratorSuccess})]});};","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","CategoryNode","AddItemInput","AITreeGenerator","apiClient","buildTree","updateTreeItem","removeTreeItem","findTreeItem","getExpandedIds","moveItemAcrossCategories","Loader2","Sparkles","Tag","jsx","_jsx","jsxs","_jsxs","VocabTree","categories","setCategories","isLoading","setIsLoading","error","setError","showAIGenerator","setShowAIGenerator","showAddCategory","setShowAddCategory","categoriesRef","current","loadCategories","categoriesData","getCategories","console","log","categoryErr","allCards","getCardsHierarchy","treeData","id","name","isExpanded","children","categoriesWithChildren","Promise","all","map","category","cards","err","concat","_err$response","_err$response$data","message","response","data","detail","handleToggle","prevCategories","_findTreeItem","_objectSpread","handleRename","newName","isCategory","some","cat","updateCard","_err$response2","_err$response2$data","handleDelete","handleCategoryRefresh","categoryId","expandFolderId","currentCategory","find","expandedIds","Set","add","updatedCards","updatedTreeData","handleAddCategory","newCategory","createCategory","newCategoryItem","_err$response3","_err$response3$data","handleMove","itemId","originalCategories","JSON","parse","stringify","_data$parent_id","_data$category_id","updated","parent_id","category_id","moveCard","_err$response4","_err$response4$data","handleAIGeneratorSuccess","className","onClick","parentId","type","onSubmit","onCancel","placeholder","length","onToggle","onRename","onDelete","onAddChild","onMove","onCategoryUpdate","onCategoryRefresh","onClose","onSuccess"],"sources":["/Users/tassiobs/Documents/vocatree-fe/src/components/VocabTree.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { CategoryItem } from '../types';\nimport { CategoryNode } from './CategoryNode';\nimport { AddItemInput } from './AddItemInput';\nimport { AITreeGenerator } from './AITreeGenerator';\nimport { apiClient } from '../services/api';\nimport { buildTree, updateTreeItem, removeTreeItem, moveTreeItem, findTreeItem, getExpandedIds, moveItemAcrossCategories } from '../utils/treeUtils';\nimport { Loader2, Sparkles, Tag } from 'lucide-react';\n\nexport const VocabTree: React.FC = () => {\n  const [categories, setCategories] = useState<CategoryItem[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [showAIGenerator, setShowAIGenerator] = useState(false);\n  const [showAddCategory, setShowAddCategory] = useState(false);\n  const categoriesRef = useRef<CategoryItem[]>([]);\n\n  // Keep ref in sync with state\n  useEffect(() => {\n    categoriesRef.current = categories;\n  }, [categories]);\n\n  // Load initial data\n  useEffect(() => {\n    loadCategories();\n  }, []);\n\n  const loadCategories = async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      \n      // First try to get categories\n      let categoriesData;\n      try {\n        categoriesData = await apiClient.getCategories();\n        console.log('Categories response:', categoriesData);\n      } catch (categoryErr: any) {\n        console.error('Categories endpoint error:', categoryErr);\n        // If categories endpoint doesn't exist, fall back to loading all cards without categories\n        const allCards = await apiClient.getCardsHierarchy();\n        const treeData = buildTree(allCards);\n        \n        // Create a default \"All Items\" category\n        setCategories([{\n          id: 0,\n          name: 'All Items',\n          isExpanded: true,\n          children: treeData,\n        }]);\n        setIsLoading(false);\n        return;\n      }\n      \n      const categoriesWithChildren = await Promise.all(\n        categoriesData.map(async (category) => {\n          try {\n            const cards = await apiClient.getCardsHierarchy(category.id);\n            const treeData = buildTree(cards);\n            return {\n              id: category.id,\n              name: category.name,\n              isExpanded: false,\n              children: treeData,\n            };\n          } catch (err: any) {\n            console.error(`Error loading cards for category ${category.id}:`, err);\n            return {\n              id: category.id,\n              name: category.name,\n              isExpanded: false,\n              children: [],\n            };\n          }\n        })\n      );\n      setCategories(categoriesWithChildren);\n    } catch (err: any) {\n      console.error('Error loading categories:', err);\n      setError(`Failed to load categories: ${err.message || err.response?.data?.detail || 'Unknown error'}`);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleToggle = useCallback((id: number) => {\n    setCategories(prevCategories => \n      prevCategories.map(category => {\n        if (category.id === id) {\n          return { ...category, isExpanded: !category.isExpanded };\n        }\n        return {\n          ...category,\n          children: updateTreeItem(category.children, id, { \n            isExpanded: !findTreeItem(category.children, id)?.isExpanded \n          })\n        };\n      })\n    );\n  }, []);\n\n  const handleRename = useCallback(async (id: number, newName: string) => {\n    try {\n      // Check if this is a category rename\n      // Note: CategoryNode already makes the API call for categories, so we only update UI\n      // For non-categories (cards/folders), we need to make the API call\n      const isCategory = categories.some(cat => cat.id === id);\n      \n      if (!isCategory) {\n        // For non-categories, make the API call\n        await apiClient.updateCard(id, { name: newName });\n      }\n      \n      // Update UI state for both categories and non-categories\n      setCategories(prevCategories => \n        prevCategories.map(category => {\n          // Check if this is a category rename\n          if (category.id === id) {\n            return { ...category, name: newName };\n          }\n          // Otherwise, update children\n          return {\n            ...category,\n            children: updateTreeItem(category.children, id, { name: newName })\n          };\n        })\n      );\n    } catch (err: any) {\n      setError(err.response?.data?.detail || 'Failed to rename item');\n      console.error('Error renaming item:', err);\n    }\n  }, [categories]);\n\n  const handleDelete = useCallback((id: number) => {\n    // This function is called after the API delete has already been handled by handleConditionalDelete\n    // We just need to update the UI state\n    console.log(`VocabTree handleDelete called for item ${id} - updating UI only`);\n    setCategories(prevCategories => \n      prevCategories.map(category => ({\n        ...category,\n        children: removeTreeItem(category.children, id)\n      }))\n    );\n  }, []);\n\n  const handleCategoryRefresh = useCallback(async (categoryId: number, expandFolderId?: number) => {\n    try {\n      setCategories(prevCategories => {\n        // Find the category to get current expanded state\n        const currentCategory = prevCategories.find(cat => cat.id === categoryId);\n        \n        // Get currently expanded IDs\n        const expandedIds = currentCategory ? getExpandedIds(currentCategory.children) : new Set<number>();\n        \n        // If we have a folder to expand, add it to the set\n        if (expandFolderId) {\n          expandedIds.add(expandFolderId);\n        }\n        \n        return prevCategories; // Return unchanged for now, will update after fetch\n      });\n      \n      const updatedCards = await apiClient.getCardsHierarchy(categoryId);\n      \n      setCategories(prevCategories => {\n        const currentCategory = prevCategories.find(cat => cat.id === categoryId);\n        const expandedIds = currentCategory ? getExpandedIds(currentCategory.children) : new Set<number>();\n        \n        if (expandFolderId) {\n          expandedIds.add(expandFolderId);\n        }\n        \n        const updatedTreeData = buildTree(updatedCards, expandedIds);\n        \n        return prevCategories.map(category => {\n          if (category.id === categoryId) {\n            return {\n              ...category,\n              children: updatedTreeData,\n              isExpanded: true, // Auto-expand when adding children\n            };\n          }\n          return category;\n        });\n      });\n    } catch (err: any) {\n      console.error('Error refreshing category:', err);\n    }\n  }, []);\n\n  const handleAddCategory = async (name: string) => {\n    try {\n      const newCategory = await apiClient.createCategory(name);\n      const newCategoryItem: CategoryItem = {\n        id: newCategory.id,\n        name: newCategory.name,\n        isExpanded: false,\n        children: [],\n      };\n\n      setCategories(prevCategories => [...prevCategories, newCategoryItem]);\n      setShowAddCategory(false);\n    } catch (err: any) {\n      console.error('Error adding category:', err);\n      setError(`Failed to add category: ${err.message || err.response?.data?.detail || 'Unknown error'}`);\n    }\n  };\n\n  const handleMove = useCallback(async (itemId: number, data: { parent_id?: number | null; category_id?: number | null }) => {\n    // Store original state for rollback on error (deep clone using JSON)\n    const originalCategories = JSON.parse(JSON.stringify(categoriesRef.current));\n    \n    // Optimistically update UI\n    setCategories(prevCategories => {\n      const updated = moveItemAcrossCategories(\n        prevCategories,\n        itemId,\n        data.parent_id ?? null,\n        data.category_id ?? null\n      );\n      // Update ref with new state\n      categoriesRef.current = updated;\n      return updated;\n    });\n    \n    try {\n      await apiClient.moveCard(itemId, data);\n      // Success - UI already updated optimistically\n    } catch (err: any) {\n      // Rollback on error\n      setCategories(originalCategories);\n      categoriesRef.current = originalCategories;\n      setError(err.response?.data?.detail || 'Failed to move item');\n      console.error('Error moving item:', err);\n      throw err;\n    }\n  }, []);\n\n\n\n  const handleAIGeneratorSuccess = () => {\n    loadCategories(); // Reload categories after AI generation\n  };\n\n  // Note: flattenTree utility is available for future drag and drop enhancements\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"flex items-center space-x-2\">\n          <Loader2 className=\"h-6 w-6 animate-spin text-primary-600\" />\n          <span className=\"text-gray-600\">Loading vocabulary tree...</span>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"rounded-md bg-red-50 p-4\">\n        <div className=\"text-sm text-red-700\">{error}</div>\n        <button\n          onClick={loadCategories}\n          className=\"mt-2 text-sm text-red-600 hover:text-red-800 underline\"\n        >\n          Try again\n        </button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <h1 className=\"text-2xl font-bold text-gray-900\">Vocabulary Tree</h1>\n        <div className=\"flex items-center space-x-2\">\n          <button\n            onClick={() => setShowAIGenerator(true)}\n            className=\"flex items-center space-x-1 px-3 py-2 text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 rounded-md transition-colors\"\n          >\n            <Sparkles className=\"h-4 w-4\" />\n            <span>Generate with AI</span>\n          </button>\n          <button\n            onClick={() => setShowAddCategory(true)}\n            className=\"flex items-center space-x-1 px-3 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-md transition-colors\"\n          >\n            <Tag className=\"h-4 w-4\" />\n            <span>Add Category</span>\n          </button>\n        </div>\n      </div>\n\n      {/* Add category input */}\n      {showAddCategory && (\n        <div className=\"border border-gray-200 rounded-lg p-4 bg-gray-50\">\n          <AddItemInput\n            parentId={null}\n            type=\"folder\"\n            onSubmit={handleAddCategory}\n            onCancel={() => setShowAddCategory(false)}\n            placeholder=\"Add category...\"\n          />\n        </div>\n      )}\n\n      {/* Categories */}\n      <div className=\"space-y-4\">\n        {categories.length === 0 ? (\n          <div className=\"flex flex-col items-center justify-center py-12 text-gray-500 border border-gray-200 rounded-lg bg-white\">\n            <Tag className=\"h-12 w-12 mb-4 opacity-50\" />\n            <p className=\"text-lg font-medium mb-2\">No categories yet</p>\n            <p className=\"text-sm mb-4\">Start by adding your first category</p>\n            <button\n              onClick={() => setShowAddCategory(true)}\n              className=\"px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-md\"\n            >\n              Add Category\n            </button>\n          </div>\n        ) : (\n          categories.map((category) => (\n            <CategoryNode\n              key={category.id}\n              category={category}\n              onToggle={handleToggle}\n              onRename={handleRename}\n              onDelete={handleDelete}\n              onAddChild={() => {}} // Not used anymore\n              onMove={handleMove}\n              onCategoryUpdate={loadCategories}\n              onCategoryRefresh={handleCategoryRefresh}\n              categories={categories}\n            />\n          ))\n        )}\n      </div>\n\n      {/* AI Tree Generator Modal */}\n      {showAIGenerator && (\n        <AITreeGenerator\n          onClose={() => setShowAIGenerator(false)}\n          onSuccess={handleAIGeneratorSuccess}\n        />\n      )}\n    </div>\n  );\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}