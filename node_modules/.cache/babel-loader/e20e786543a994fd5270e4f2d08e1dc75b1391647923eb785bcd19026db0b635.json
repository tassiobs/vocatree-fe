{"ast":null,"code":"var _jsxFileName = \"/Users/tassiobs/Documents/vocatree-fe/src/components/FolderView.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { TreeNode } from './TreeNode';\nimport { AddItemInput } from './AddItemInput';\nimport { AICardForm } from './AICardForm';\nimport { DropdownMenu, createEditAction, createDeleteAction, createAICardAction } from './DropdownMenu';\nimport { handleConditionalDelete } from '../utils/deleteUtils';\nimport { MoveToModal } from './MoveToModal';\nimport { X, Folder, Loader2, FileText, Plus, Check, Move } from 'lucide-react';\nimport { apiClient } from '../services/api';\nimport { cardToTreeItem } from '../utils/treeUtils';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const FolderView = ({\n  folder,\n  onClose,\n  onRename,\n  onDelete,\n  onMove,\n  onRefresh,\n  categories = []\n}) => {\n  _s();\n  const [folderData, setFolderData] = useState(folder);\n  const [isLoading, setIsLoading] = useState(false);\n  const [expandedIds, setExpandedIds] = useState(new Set());\n  const [isEditing, setIsEditing] = useState(false);\n  const [editName, setEditName] = useState(folder.name);\n  const [showAddInput, setShowAddInput] = useState(false);\n  const [addType, setAddType] = useState('card');\n  const [isDeleting, setIsDeleting] = useState(false);\n  const [isSaving, setIsSaving] = useState(false);\n  const [showAICardForm, setShowAICardForm] = useState(false);\n  const [showMoveToModal, setShowMoveToModal] = useState(false);\n  const isRootFolder = folder.parent_id === null;\n  useEffect(() => {\n    loadFolderData();\n  }, [folder.id]);\n\n  // Sync editName with folder.name when folder changes\n  useEffect(() => {\n    if (!isEditing) {\n      setEditName(folderData.name);\n    }\n  }, [folderData.name, isEditing]);\n  const loadFolderData = async () => {\n    try {\n      setIsLoading(true);\n      // Get the folder's direct children\n      const response = await apiClient.getCardsByParent(folder.id);\n      const children = response.items.map(card => cardToTreeItem(card));\n      setFolderData({\n        ...folder,\n        children: children\n      });\n    } catch (err) {\n      console.error('Error loading folder data:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handleToggle = id => {\n    setExpandedIds(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(id)) {\n        newSet.delete(id);\n      } else {\n        newSet.add(id);\n      }\n\n      // Update the tree items with new expansion state\n      const updateTreeExpansion = items => {\n        return items.map(item => ({\n          ...item,\n          isExpanded: newSet.has(item.id),\n          children: item.children ? updateTreeExpansion(item.children) : []\n        }));\n      };\n      setFolderData(prev => ({\n        ...prev,\n        children: updateTreeExpansion(prev.children)\n      }));\n      return newSet;\n    });\n  };\n  const handleAddChildToFolder = async (parentId, type, name) => {\n    try {\n      await apiClient.createCard({\n        name,\n        parent_id: parentId,\n        is_folder: type === 'folder',\n        category_id: folder.category_id\n      });\n\n      // Refresh the folder data\n      await loadFolderData();\n      if (onRefresh) {\n        onRefresh();\n      }\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error('Error adding child to folder:', err);\n      const errorMessage = err.message || ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.detail) || 'Failed to add item';\n      alert(`Failed to add item: ${errorMessage}`);\n    }\n  };\n  const handleRename = async () => {\n    if (!editName.trim()) {\n      setEditName(folderData.name);\n      setIsEditing(false);\n      return;\n    }\n    if (editName.trim() === folderData.name) {\n      setIsEditing(false);\n      return;\n    }\n    try {\n      setIsSaving(true);\n      await apiClient.updateCard(folderData.id, {\n        name: editName.trim()\n      });\n      onRename(folderData.id, editName.trim());\n      setFolderData({\n        ...folderData,\n        name: editName.trim()\n      });\n      setIsEditing(false);\n      if (onRefresh) {\n        onRefresh();\n      }\n    } catch (err) {\n      console.error('Error renaming folder:', err);\n      setEditName(folderData.name);\n      alert('Failed to rename folder. Please try again.');\n    } finally {\n      setIsSaving(false);\n    }\n  };\n  const handleCancelEdit = () => {\n    setEditName(folderData.name);\n    setIsEditing(false);\n  };\n  const handleKeyDown = e => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      handleRename();\n    } else if (e.key === 'Escape') {\n      handleCancelEdit();\n    }\n  };\n  const handleBlur = e => {\n    const relatedTarget = e.relatedTarget;\n    if (relatedTarget && (relatedTarget.closest('.edit-actions') || relatedTarget.closest('button'))) {\n      return;\n    }\n    setTimeout(() => {\n      if (isEditing) {\n        handleRename();\n      }\n    }, 200);\n  };\n  const handleDelete = async () => {\n    try {\n      setIsDeleting(true);\n      await handleConditionalDelete(folderData, () => {\n        onDelete(folderData.id);\n        onClose();\n      }, error => {\n        console.error('Error deleting folder:', error);\n        alert('Failed to delete folder');\n      });\n    } finally {\n      setIsDeleting(false);\n    }\n  };\n  const handleAddChild = async name => {\n    try {\n      await apiClient.createCard({\n        name,\n        parent_id: folderData.id,\n        is_folder: addType === 'folder',\n        category_id: folderData.category_id\n      });\n      await loadFolderData();\n      setShowAddInput(false);\n      if (onRefresh) {\n        onRefresh();\n      }\n    } catch (err) {\n      console.error('Error adding child:', err);\n      alert('Failed to add item');\n    }\n  };\n  const handleAddFolder = () => {\n    setAddType('folder');\n    setShowAddInput(true);\n  };\n  const handleAddCard = () => {\n    setAddType('card');\n    setShowAddInput(true);\n  };\n  const handleAICardSuccess = cardId => {\n    setShowAICardForm(false);\n    loadFolderData();\n    if (onRefresh) {\n      onRefresh();\n    }\n  };\n\n  // Create dropdown menu items for folder\n  const getFolderDropdownItems = () => {\n    const items = [createEditAction(() => setIsEditing(true)), {\n      id: 'move',\n      label: 'Move To...',\n      icon: /*#__PURE__*/_jsxDEV(Move, {\n        className: \"h-4 w-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 15\n      }, this),\n      onClick: () => setShowMoveToModal(true)\n    }, createDeleteAction(handleDelete), createAICardAction(() => setShowAICardForm(true))];\n    return items;\n  };\n\n  // Count items\n  const totalItems = folderData.children.length;\n  const folderCount = folderData.children.filter(child => child.is_folder).length;\n  const cardCount = folderData.children.filter(child => !child.is_folder).length;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto p-4\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] flex flex-col\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-3 flex-1 min-w-0\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-2 bg-blue-100 rounded-lg flex-shrink-0\",\n            children: /*#__PURE__*/_jsxDEV(Folder, {\n              className: \"h-5 w-5 sm:h-6 sm:w-6 text-blue-600\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 265,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-1 min-w-0\",\n            children: isEditing ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                value: editName,\n                onChange: e => setEditName(e.target.value),\n                onBlur: handleBlur,\n                onKeyDown: handleKeyDown,\n                className: \"flex-1 border border-blue-300 rounded-md px-3 py-1 text-lg sm:text-xl font-bold bg-white text-blue-900 focus:outline-none focus:ring-2 focus:ring-blue-500\",\n                autoFocus: true,\n                disabled: isSaving\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 270,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"edit-actions flex items-center space-x-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: handleRename,\n                  disabled: isSaving || !editName.trim(),\n                  className: \"p-1.5 hover:bg-green-100 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed\",\n                  title: \"Save\",\n                  children: /*#__PURE__*/_jsxDEV(Check, {\n                    className: \"h-5 w-5 text-green-600\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 287,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 281,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: handleCancelEdit,\n                  disabled: isSaving,\n                  className: \"p-1.5 hover:bg-red-100 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed\",\n                  title: \"Cancel\",\n                  children: /*#__PURE__*/_jsxDEV(X, {\n                    className: \"h-5 w-5 text-red-600\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 295,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 289,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 280,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 269,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"text-lg sm:text-xl font-bold text-blue-900 truncate\",\n                children: folderData.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 301,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex flex-wrap items-center gap-2 sm:gap-4 mt-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xs sm:text-sm text-blue-600\",\n                  children: [totalItems, \" \", totalItems === 1 ? 'item' : 'items']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 305,\n                  columnNumber: 21\n                }, this), folderCount > 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xs sm:text-sm text-blue-600 flex items-center\",\n                  children: [/*#__PURE__*/_jsxDEV(Folder, {\n                    className: \"h-3 w-3 mr-1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 310,\n                    columnNumber: 25\n                  }, this), folderCount, \" \", folderCount === 1 ? 'folder' : 'folders']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 309,\n                  columnNumber: 23\n                }, this), cardCount > 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xs sm:text-sm text-blue-600 flex items-center\",\n                  children: [/*#__PURE__*/_jsxDEV(FileText, {\n                    className: \"h-3 w-3 mr-1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 316,\n                    columnNumber: 25\n                  }, this), cardCount, \" \", cardCount === 1 ? 'card' : 'cards']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 315,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 304,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 11\n        }, this), !isEditing && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2 mr-2\",\n          children: [isRootFolder && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleAddFolder,\n            className: \"p-2 hover:bg-blue-100 rounded-lg bg-blue-50 transition-colors\",\n            title: \"Add subfolder\",\n            children: /*#__PURE__*/_jsxDEV(Folder, {\n              className: \"h-4 w-4 text-blue-600\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 335,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 330,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleAddCard,\n            className: \"p-2 hover:bg-gray-200 rounded-lg bg-gray-100 transition-colors\",\n            title: \"Add card\",\n            children: /*#__PURE__*/_jsxDEV(Plus, {\n              className: \"h-4 w-4 text-gray-700\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 343,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 338,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 13\n        }, this), !isEditing && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mr-2\",\n          children: /*#__PURE__*/_jsxDEV(DropdownMenu, {\n            items: getFolderDropdownItems(),\n            className: \"opacity-100\",\n            disabled: isDeleting\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 351,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 350,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onClose,\n          className: \"p-2 hover:bg-blue-100 rounded-lg transition-colors flex-shrink-0 ml-2\",\n          title: \"Close\",\n          children: /*#__PURE__*/_jsxDEV(X, {\n            className: \"h-5 w-5 text-blue-600\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 364,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 359,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 9\n      }, this), showAddInput && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"px-4 sm:px-6 py-4 bg-gray-50 border-b border-gray-100\",\n        children: /*#__PURE__*/_jsxDEV(AddItemInput, {\n          parentId: folderData.id,\n          type: addType,\n          onSubmit: handleAddChild,\n          onCancel: () => setShowAddInput(false),\n          placeholder: `Add ${addType}...`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 371,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 370,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1 overflow-y-auto p-4 sm:p-6\",\n        children: isLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-center py-12\",\n          children: [/*#__PURE__*/_jsxDEV(Loader2, {\n            className: \"h-6 w-6 animate-spin text-blue-600\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 385,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"ml-2 text-gray-600\",\n            children: \"Loading folder...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 386,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 384,\n          columnNumber: 13\n        }, this) : folderData.children.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col items-center justify-center py-12 text-gray-500\",\n          children: [/*#__PURE__*/_jsxDEV(Folder, {\n            className: \"h-12 w-12 mb-4 opacity-50\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-lg font-medium mb-2\",\n            children: \"No items in this folder\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 391,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-center mb-4\",\n            children: isRootFolder ? 'Add subfolders or cards to get started' : 'Add cards to get started'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 392,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-center space-x-2\",\n            children: [isRootFolder && /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: handleAddFolder,\n              className: \"px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors\",\n              children: \"Add Subfolder\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 397,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: handleAddCard,\n              className: \"px-4 py-2 text-sm font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors\",\n              children: \"Add Card\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 404,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 395,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 389,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: folderData.children.map(item => /*#__PURE__*/_jsxDEV(TreeNode, {\n            item: item,\n            onToggle: handleToggle,\n            onRename: onRename,\n            onDelete: onDelete,\n            onAddChild: handleAddChildToFolder,\n            onMove: onMove,\n            level: 0,\n            categoryId: folder.category_id,\n            categories: categories\n          }, item.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 415,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 413,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 382,\n        columnNumber: 9\n      }, this), showAICardForm && /*#__PURE__*/_jsxDEV(AICardForm, {\n        parentId: folderData.id,\n        parentName: folderData.name,\n        onClose: () => setShowAICardForm(false),\n        onSuccess: handleAICardSuccess\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 11\n      }, this), showMoveToModal && categories.length > 0 && /*#__PURE__*/_jsxDEV(MoveToModal, {\n        item: folderData,\n        categories: categories,\n        onClose: () => setShowMoveToModal(false),\n        onMove: onMove\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 444,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 259,\n    columnNumber: 5\n  }, this);\n};\n_s(FolderView, \"Uu/sIRpTnRKQLJqOmz/TCrtn8aY=\");\n_c = FolderView;\nvar _c;\n$RefreshReg$(_c, \"FolderView\");","map":{"version":3,"names":["React","useState","useEffect","TreeNode","AddItemInput","AICardForm","DropdownMenu","createEditAction","createDeleteAction","createAICardAction","handleConditionalDelete","MoveToModal","X","Folder","Loader2","FileText","Plus","Check","Move","apiClient","cardToTreeItem","jsxDEV","_jsxDEV","Fragment","_Fragment","FolderView","folder","onClose","onRename","onDelete","onMove","onRefresh","categories","_s","folderData","setFolderData","isLoading","setIsLoading","expandedIds","setExpandedIds","Set","isEditing","setIsEditing","editName","setEditName","name","showAddInput","setShowAddInput","addType","setAddType","isDeleting","setIsDeleting","isSaving","setIsSaving","showAICardForm","setShowAICardForm","showMoveToModal","setShowMoveToModal","isRootFolder","parent_id","loadFolderData","id","response","getCardsByParent","children","items","map","card","err","console","error","handleToggle","prev","newSet","has","delete","add","updateTreeExpansion","item","isExpanded","handleAddChildToFolder","parentId","type","createCard","is_folder","category_id","_err$response","_err$response$data","errorMessage","message","data","detail","alert","handleRename","trim","updateCard","handleCancelEdit","handleKeyDown","e","key","preventDefault","handleBlur","relatedTarget","closest","setTimeout","handleDelete","handleAddChild","handleAddFolder","handleAddCard","handleAICardSuccess","cardId","getFolderDropdownItems","label","icon","className","fileName","_jsxFileName","lineNumber","columnNumber","onClick","totalItems","length","folderCount","filter","child","cardCount","value","onChange","target","onBlur","onKeyDown","autoFocus","disabled","title","onSubmit","onCancel","placeholder","onToggle","onAddChild","level","categoryId","parentName","onSuccess","_c","$RefreshReg$"],"sources":["/Users/tassiobs/Documents/vocatree-fe/src/components/FolderView.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { TreeItem, CategoryItem } from '../types';\nimport { TreeNode } from './TreeNode';\nimport { AddItemInput } from './AddItemInput';\nimport { AICardForm } from './AICardForm';\nimport { DropdownMenu, DropdownMenuItem, createEditAction, createDeleteAction, createAICardAction, createPracticeFolderAction } from './DropdownMenu';\nimport { FolderPracticeSession } from './FolderPracticeSession';\nimport { handleConditionalDelete } from '../utils/deleteUtils';\nimport { MoveToModal } from './MoveToModal';\nimport { X, Folder, Loader2, FileText, Plus, Check, Move } from 'lucide-react';\nimport { apiClient } from '../services/api';\nimport { Card } from '../types/api';\nimport { cardToTreeItem } from '../utils/treeUtils';\n\ninterface FolderViewProps {\n  folder: TreeItem;\n  onClose: () => void;\n  onRename: (id: number, newName: string) => void;\n  onDelete: (id: number) => void;\n  onMove: (itemId: number, data: { parent_id?: number | null; category_id?: number | null }) => Promise<void>;\n  onRefresh?: () => void;\n  categories?: CategoryItem[];\n}\n\nexport const FolderView: React.FC<FolderViewProps> = ({\n  folder,\n  onClose,\n  onRename,\n  onDelete,\n  onMove,\n  onRefresh,\n  categories = [],\n}) => {\n  const [folderData, setFolderData] = useState<TreeItem>(folder);\n  const [isLoading, setIsLoading] = useState(false);\n  const [expandedIds, setExpandedIds] = useState<Set<number>>(new Set());\n  const [isEditing, setIsEditing] = useState(false);\n  const [editName, setEditName] = useState(folder.name);\n  const [showAddInput, setShowAddInput] = useState(false);\n  const [addType, setAddType] = useState<'folder' | 'card'>('card');\n  const [isDeleting, setIsDeleting] = useState(false);\n  const [isSaving, setIsSaving] = useState(false);\n  const [showAICardForm, setShowAICardForm] = useState(false);\n  const [showMoveToModal, setShowMoveToModal] = useState(false);\n  const isRootFolder = folder.parent_id === null;\n\n  useEffect(() => {\n    loadFolderData();\n  }, [folder.id]);\n\n  // Sync editName with folder.name when folder changes\n  useEffect(() => {\n    if (!isEditing) {\n      setEditName(folderData.name);\n    }\n  }, [folderData.name, isEditing]);\n\n  const loadFolderData = async () => {\n    try {\n      setIsLoading(true);\n      // Get the folder's direct children\n      const response = await apiClient.getCardsByParent(folder.id);\n      const children: TreeItem[] = response.items.map((card: Card) => cardToTreeItem(card));\n      \n      setFolderData({\n        ...folder,\n        children: children,\n      });\n    } catch (err: any) {\n      console.error('Error loading folder data:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleToggle = (id: number) => {\n    setExpandedIds((prev) => {\n      const newSet = new Set(prev);\n      if (newSet.has(id)) {\n        newSet.delete(id);\n      } else {\n        newSet.add(id);\n      }\n      \n      // Update the tree items with new expansion state\n      const updateTreeExpansion = (items: TreeItem[]): TreeItem[] => {\n        return items.map((item) => ({\n          ...item,\n          isExpanded: newSet.has(item.id),\n          children: item.children ? updateTreeExpansion(item.children) : [],\n        }));\n      };\n      \n      setFolderData((prev) => ({\n        ...prev,\n        children: updateTreeExpansion(prev.children),\n      }));\n      \n      return newSet;\n    });\n  };\n\n  const handleAddChildToFolder = async (parentId: number, type: 'folder' | 'card', name: string) => {\n    try {\n      await apiClient.createCard({\n        name,\n        parent_id: parentId,\n        is_folder: type === 'folder',\n        category_id: folder.category_id,\n      });\n\n      // Refresh the folder data\n      await loadFolderData();\n      if (onRefresh) {\n        onRefresh();\n      }\n    } catch (err: any) {\n      console.error('Error adding child to folder:', err);\n      const errorMessage = err.message || err.response?.data?.detail || 'Failed to add item';\n      alert(`Failed to add item: ${errorMessage}`);\n    }\n  };\n\n  const handleRename = async () => {\n    if (!editName.trim()) {\n      setEditName(folderData.name);\n      setIsEditing(false);\n      return;\n    }\n\n    if (editName.trim() === folderData.name) {\n      setIsEditing(false);\n      return;\n    }\n\n    try {\n      setIsSaving(true);\n      await apiClient.updateCard(folderData.id, { name: editName.trim() });\n      onRename(folderData.id, editName.trim());\n      setFolderData({ ...folderData, name: editName.trim() });\n      setIsEditing(false);\n      if (onRefresh) {\n        onRefresh();\n      }\n    } catch (err: any) {\n      console.error('Error renaming folder:', err);\n      setEditName(folderData.name);\n      alert('Failed to rename folder. Please try again.');\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleCancelEdit = () => {\n    setEditName(folderData.name);\n    setIsEditing(false);\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      handleRename();\n    } else if (e.key === 'Escape') {\n      handleCancelEdit();\n    }\n  };\n\n  const handleBlur = (e: React.FocusEvent<HTMLInputElement>) => {\n    const relatedTarget = e.relatedTarget as HTMLElement;\n    if (relatedTarget && (relatedTarget.closest('.edit-actions') || relatedTarget.closest('button'))) {\n      return;\n    }\n    setTimeout(() => {\n      if (isEditing) {\n        handleRename();\n      }\n    }, 200);\n  };\n\n  const handleDelete = async () => {\n    try {\n      setIsDeleting(true);\n      await handleConditionalDelete(\n        folderData,\n        () => {\n          onDelete(folderData.id);\n          onClose();\n        },\n        (error) => {\n          console.error('Error deleting folder:', error);\n          alert('Failed to delete folder');\n        }\n      );\n    } finally {\n      setIsDeleting(false);\n    }\n  };\n\n  const handleAddChild = async (name: string) => {\n    try {\n      await apiClient.createCard({\n        name,\n        parent_id: folderData.id,\n        is_folder: addType === 'folder',\n        category_id: folderData.category_id,\n      });\n\n      await loadFolderData();\n      setShowAddInput(false);\n      if (onRefresh) {\n        onRefresh();\n      }\n    } catch (err: any) {\n      console.error('Error adding child:', err);\n      alert('Failed to add item');\n    }\n  };\n\n  const handleAddFolder = () => {\n    setAddType('folder');\n    setShowAddInput(true);\n  };\n\n  const handleAddCard = () => {\n    setAddType('card');\n    setShowAddInput(true);\n  };\n\n  const handleAICardSuccess = (cardId: number) => {\n    setShowAICardForm(false);\n    loadFolderData();\n    if (onRefresh) {\n      onRefresh();\n    }\n  };\n\n  // Create dropdown menu items for folder\n  const getFolderDropdownItems = (): DropdownMenuItem[] => {\n    const items: DropdownMenuItem[] = [\n      createEditAction(() => setIsEditing(true)),\n      {\n        id: 'move',\n        label: 'Move To...',\n        icon: <Move className=\"h-4 w-4\" />,\n        onClick: () => setShowMoveToModal(true),\n      },\n      createDeleteAction(handleDelete),\n      createAICardAction(() => setShowAICardForm(true)),\n    ];\n    return items;\n  };\n\n  // Count items\n  const totalItems = folderData.children.length;\n  const folderCount = folderData.children.filter(child => child.is_folder).length;\n  const cardCount = folderData.children.filter(child => !child.is_folder).length;\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto p-4\">\n      <div className=\"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] flex flex-col\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50\">\n          <div className=\"flex items-center space-x-3 flex-1 min-w-0\">\n            <div className=\"p-2 bg-blue-100 rounded-lg flex-shrink-0\">\n              <Folder className=\"h-5 w-5 sm:h-6 sm:w-6 text-blue-600\" />\n            </div>\n            <div className=\"flex-1 min-w-0\">\n              {isEditing ? (\n                <div className=\"flex items-center space-x-2\">\n                  <input\n                    type=\"text\"\n                    value={editName}\n                    onChange={(e) => setEditName(e.target.value)}\n                    onBlur={handleBlur}\n                    onKeyDown={handleKeyDown}\n                    className=\"flex-1 border border-blue-300 rounded-md px-3 py-1 text-lg sm:text-xl font-bold bg-white text-blue-900 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    autoFocus\n                    disabled={isSaving}\n                  />\n                  <div className=\"edit-actions flex items-center space-x-1\">\n                    <button\n                      onClick={handleRename}\n                      disabled={isSaving || !editName.trim()}\n                      className=\"p-1.5 hover:bg-green-100 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                      title=\"Save\"\n                    >\n                      <Check className=\"h-5 w-5 text-green-600\" />\n                    </button>\n                    <button\n                      onClick={handleCancelEdit}\n                      disabled={isSaving}\n                      className=\"p-1.5 hover:bg-red-100 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                      title=\"Cancel\"\n                    >\n                      <X className=\"h-5 w-5 text-red-600\" />\n                    </button>\n                  </div>\n                </div>\n              ) : (\n                <>\n                  <h2 className=\"text-lg sm:text-xl font-bold text-blue-900 truncate\">\n                    {folderData.name}\n                  </h2>\n                  <div className=\"flex flex-wrap items-center gap-2 sm:gap-4 mt-1\">\n                    <p className=\"text-xs sm:text-sm text-blue-600\">\n                      {totalItems} {totalItems === 1 ? 'item' : 'items'}\n                    </p>\n                    {folderCount > 0 && (\n                      <p className=\"text-xs sm:text-sm text-blue-600 flex items-center\">\n                        <Folder className=\"h-3 w-3 mr-1\" />\n                        {folderCount} {folderCount === 1 ? 'folder' : 'folders'}\n                      </p>\n                    )}\n                    {cardCount > 0 && (\n                      <p className=\"text-xs sm:text-sm text-blue-600 flex items-center\">\n                        <FileText className=\"h-3 w-3 mr-1\" />\n                        {cardCount} {cardCount === 1 ? 'card' : 'cards'}\n                      </p>\n                    )}\n                  </div>\n                </>\n              )}\n            </div>\n          </div>\n          \n          {/* Add buttons */}\n          {!isEditing && (\n            <div className=\"flex items-center space-x-2 mr-2\">\n              {isRootFolder && (\n                <button\n                  onClick={handleAddFolder}\n                  className=\"p-2 hover:bg-blue-100 rounded-lg bg-blue-50 transition-colors\"\n                  title=\"Add subfolder\"\n                >\n                  <Folder className=\"h-4 w-4 text-blue-600\" />\n                </button>\n              )}\n              <button\n                onClick={handleAddCard}\n                className=\"p-2 hover:bg-gray-200 rounded-lg bg-gray-100 transition-colors\"\n                title=\"Add card\"\n              >\n                <Plus className=\"h-4 w-4 text-gray-700\" />\n              </button>\n            </div>\n          )}\n\n          {/* Actions dropdown menu */}\n          {!isEditing && (\n            <div className=\"mr-2\">\n              <DropdownMenu\n                items={getFolderDropdownItems()}\n                className=\"opacity-100\"\n                disabled={isDeleting}\n              />\n            </div>\n          )}\n\n          <button\n            onClick={onClose}\n            className=\"p-2 hover:bg-blue-100 rounded-lg transition-colors flex-shrink-0 ml-2\"\n            title=\"Close\"\n          >\n            <X className=\"h-5 w-5 text-blue-600\" />\n          </button>\n        </div>\n\n        {/* Add item input */}\n        {showAddInput && (\n          <div className=\"px-4 sm:px-6 py-4 bg-gray-50 border-b border-gray-100\">\n            <AddItemInput\n              parentId={folderData.id}\n              type={addType}\n              onSubmit={handleAddChild}\n              onCancel={() => setShowAddInput(false)}\n              placeholder={`Add ${addType}...`}\n            />\n          </div>\n        )}\n\n        {/* Content */}\n        <div className=\"flex-1 overflow-y-auto p-4 sm:p-6\">\n          {isLoading ? (\n            <div className=\"flex items-center justify-center py-12\">\n              <Loader2 className=\"h-6 w-6 animate-spin text-blue-600\" />\n              <span className=\"ml-2 text-gray-600\">Loading folder...</span>\n            </div>\n          ) : folderData.children.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center py-12 text-gray-500\">\n              <Folder className=\"h-12 w-12 mb-4 opacity-50\" />\n              <p className=\"text-lg font-medium mb-2\">No items in this folder</p>\n              <p className=\"text-sm text-center mb-4\">\n                {isRootFolder ? 'Add subfolders or cards to get started' : 'Add cards to get started'}\n              </p>\n              <div className=\"flex items-center justify-center space-x-2\">\n                {isRootFolder && (\n                  <button\n                    onClick={handleAddFolder}\n                    className=\"px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors\"\n                  >\n                    Add Subfolder\n                  </button>\n                )}\n                <button\n                  onClick={handleAddCard}\n                  className=\"px-4 py-2 text-sm font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors\"\n                >\n                  Add Card\n                </button>\n              </div>\n            </div>\n          ) : (\n            <div className=\"space-y-2\">\n              {folderData.children.map((item) => (\n                <TreeNode\n                  key={item.id}\n                  item={item}\n                  onToggle={handleToggle}\n                  onRename={onRename}\n                  onDelete={onDelete}\n                  onAddChild={handleAddChildToFolder}\n                  onMove={onMove}\n                  level={0}\n                  categoryId={folder.category_id}\n                  categories={categories}\n                />\n              ))}\n            </div>\n          )}\n        </div>\n\n        {/* AI Card Form Modal */}\n        {showAICardForm && (\n          <AICardForm\n            parentId={folderData.id}\n            parentName={folderData.name}\n            onClose={() => setShowAICardForm(false)}\n            onSuccess={handleAICardSuccess}\n          />\n        )}\n\n        {/* Move To Modal */}\n        {showMoveToModal && categories.length > 0 && (\n          <MoveToModal\n            item={folderData}\n            categories={categories}\n            onClose={() => setShowMoveToModal(false)}\n            onMove={onMove}\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}